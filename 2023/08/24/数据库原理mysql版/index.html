<!DOCTYPE html>
<html lang="zh-CN.yml | en">
  <head>
  <meta charset="UTF-8">
  <meta 
    name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <meta 
    http-equiv="X-UA-Compatible" 
    content="ie=edge">
  <meta 
    name="theme-color" 
    content="#fff" 
    id="theme-color">
  <meta 
    name="description" 
    content="jkloli的博客">
  <link 
    rel="icon" 
    href="/img/logo.jpg">
  <title>数据库原理mysql版</title>
  
    
      <meta 
        property="og:title" 
        content="数据库原理mysql版">
    
    
      <meta 
        property="og:url" 
        content="https://eyjafjalla6.github.io/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/index.html">
    
    
      <meta 
        property="og:img" 
        content="/img/authorhead.jpg">
    
    
    
      <meta 
        property="og:type" 
        content="article">
      <meta 
        property="og:article:published_time" 
        content="2023-08-24">
      <meta 
        property="og:article:modified_time" 
        content="2023-10-05">
      <meta 
        property="og:article:author" 
        content="jkloli">
      
        
      
    
  
  
  <link rel="preload" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" as="style" >
  <link rel="preload" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" as="style" >
  <link rel="preload" href="/css/main.css" as="style" >
  
  <link rel="modulepreload" href="//instant.page/5.1.0">
  
  <link rel="stylesheet" href="/css/main.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css">
  
  
  
    <link rel="stylesheet" href="/js/lib/lightbox/baguetteBox.min.css">
  
  <script>
    function loadScript(url, cb) {
      var script = document.createElement('script');
      script.src = url;
      if (cb) script.onload = cb;
      script.async = true;
      document.body.appendChild(script);
    }
    function loadCSS(href, data, attr) {
      var sheet = document.createElement('link');
      sheet.ref = 'stylesheet';
      sheet.href = href;
      sheet.dataset[data] = attr;
      document.head.appendChild(sheet);
    }
    function changeCSS(cssFile, data, attr) {
      var oldlink = document.querySelector(data);
      var newlink = document.createElement("link");
      newlink.setAttribute("rel", "stylesheet");
      newlink.setAttribute("href", cssFile);
      newlink.dataset.prism = attr;
      document.head.replaceChild(newlink, oldlink);
    }
  </script>
  
    
  
  <script>
    // control reverse button
    var reverseDarkList = {
      dark: 'light',
      light: 'dark'
    };
    var themeColor = {
      dark: '#1c1c1e',
      light: '#fff'
    }
    // get the data of css prefers-color-scheme
    var getCssMediaQuery = function() {
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    };
    // reverse current darkmode setting function
    var reverseDarkModeSetting = function() {
      var setting = localStorage.getItem('user-color-scheme');
      if(reverseDarkList[setting]) {
        setting = reverseDarkList[setting];
      } else if(setting === null) {
        setting = reverseDarkList[getCssMediaQuery()];
      } else {
        return;
      }
      localStorage.setItem('user-color-scheme', setting);
      return setting;
    };
    // apply current darkmode setting
  </script>
  
    <script>
      var setDarkmode = function(mode) {
      var setting = mode || localStorage.getItem('user-color-scheme');
      if(setting === getCssMediaQuery()) {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
      } else if(reverseDarkList[setting]) {
        document.documentElement.setAttribute('data-user-color-scheme', setting);
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
      } else {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[getCssMediaQuery()];
        document.getElementById('theme-color').dataset.mode = getCssMediaQuery();
      }
    };
    setDarkmode();
    </script>
  
  
  
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.js" as="script">
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.css" as="style" >
  
  
    <link rel="preload" href="/js/lib/lozad.min.js" as="script">
  
  
  
  
    
    <link rel="prefetch" href="//cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" as="script">
  
  
  
<meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

  <body>
    <div class="wrapper">
       
      <nav class="navbar">
  <div class="navbar-logo">
    <a class="navbar-logo-main" href="/">
      
        <img 
          class="navbar-logo-img"
          width="32"
          height="32"
          src="/img/logo.jpg" 
          alt="blog logo">
      
      <span class="navbar-logo-dsc">jkloli's blog</span>
      </a>
  </div>
  <div class="navbar-menu">
    
      <a 
        href="/" 
        class="navbar-menu-item">
        
          首页
        
      </a>
    
      <a 
        href="/archives" 
        class="navbar-menu-item">
        
          归档
        
      </a>
    
      <a 
        href="/tags" 
        class="navbar-menu-item">
        
          标签
        
      </a>
    
      <a 
        href="/categories" 
        class="navbar-menu-item">
        
          分类
        
      </a>
    
      <a 
        href="/about" 
        class="navbar-menu-item">
        
          关于
        
      </a>
    
      <a 
        href="/links" 
        class="navbar-menu-item">
        
          友链
        
      </a>
    
    <button 
      class="navbar-menu-item darknavbar navbar-menu-btn" 
      aria-label="Toggle dark mode"
      id="dark">
      <i class="iconfont icon-weather"></i>
    </button>
    <button 
      class="navbar-menu-item searchnavbar navbar-menu-btn" 
      aria-label="Toggle search"
      id="search">
      <!-- <i 
        class="iconfont icon-search" 
        style="font-size: 1.2rem; font-weight: 400;">
      </i> -->
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img"
        class="iconify iconify--ion" width="28" height="28" preserveAspectRatio="xMidYMid meet" viewBox="0 0 512 512">
        <path fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"
          d="M256 80a176 176 0 1 0 176 176A176 176 0 0 0 256 80Z"></path>
        <path fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"
          d="M232 160a72 72 0 1 0 72 72a72 72 0 0 0-72-72Z"></path>
        <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="28"
          d="M283.64 283.64L336 336"></path>
      </svg>
    </button>
  </div>
</nav> 
      
      <div 
        id="local-search" 
        style="display: none">
        <input
          class="navbar-menu-item"
          id="search-input"
          placeholder="请输入搜索内容..." />
        <div id="search-content"></div>
      </div>
      
      <div class="section-wrap">
        <div class="container">
          <div class="columns">
            <aside class="left-column">
              
              <div class="card card-author">
                
  <img 
    src="/img/authorhead.jpg" 
    class="author-img"
    width="88"
    height="88"
    alt="author avatar">

<p class="author-name">jkloli</p>
<p class="author-description">彩笔的秘密基地</p>
<div class="author-message">
  <a 
    class="author-posts-count" 
    href="/archives">
    <span>8</span>
    <span>文章</span>
  </a>
  <a 
    class="author-categories-count" 
    href="/categories">
    <span>5</span>
    <span>分类</span>
  </a>
  <a 
    class="author-tags-count" 
    href="/tags">
    <span>1</span>
    <span>标签</span>
  </a>
</div>

              </div>
               <div class="sticky-tablet">
  
  
    <article class="display-when-two-columns spacer">
      <div class="card card-content toc-card">
        <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86"><span class="toc-text"> 数据库原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="toc-text"> 0. 问题解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-text"> 1. 环境配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A6%82%E8%BF%B0"><span class="toc-text"> 2. 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5"><span class="toc-text"> 1. 一些概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E7%BB%86%E7%A2%8E%E7%9A%841"><span class="toc-text"> 比较细碎的1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E4%B8%96%E7%95%8C%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text"> 信息世界基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 数据模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E7%BB%86%E7%A2%8E%E7%9A%842"><span class="toc-text"> 比较细碎的2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-e-r%E5%9B%BE"><span class="toc-text"> 2. E-R图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 3. 数据库类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-text"> 4. 常见的数据库管理系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-mysql%E4%BB%8B%E7%BB%8D"><span class="toc-text"> 5. MySQL介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-sql%E6%A6%82%E8%BF%B0"><span class="toc-text"> 6. SQL概述</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-navicat%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C"><span class="toc-text"> 2. navicat基础操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8navicat%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text"> 1. 使用navicat创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5%E5%B1%9E%E6%80%A7"><span class="toc-text"> 2. 修改字段属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-text"> 3. 添加数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9F%A5%E8%AF%A2%E8%A1%A8"><span class="toc-text"> 4. 查询表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%A4%87%E4%BB%BD%E5%92%8C%E8%BF%98%E5%8E%9F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text"> 5. 备份和还原数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 3. 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 1. 数字类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BA%8B%E4%BB%B6%E5%92%8C%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 2. 事件和日期类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 3. 字符串类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-json%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 4. JSON数据类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-sql%E5%88%86%E7%B1%BB%E8%AF%A6%E8%A7%A3"><span class="toc-text"> 4. SQL分类详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-ddl-%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80"><span class="toc-text"> 1. DDL 数据定义语言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-text"> 1. 数据库操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%A1%A8%E6%93%8D%E4%BD%9C%E9%87%8D%E8%A6%81"><span class="toc-text"> 2. 表操作（重要）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-dml%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C%E8%AF%AD%E8%A8%80"><span class="toc-text"> 2. DML（数据操作语言）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE-insert"><span class="toc-text"> 1. 添加数据 insert</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text"> 注意事项</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9B%B4%E6%96%B0%E5%92%8C%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AEupdatedelete"><span class="toc-text"> 2. 更新和删除数据update,delete</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-dql%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-text"> 3. DQL（数据查询语言）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2-select"><span class="toc-text"> 1. 基础查询 select</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2-where"><span class="toc-text"> 2. 条件查询 where</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2countavg"><span class="toc-text"> 3. 聚合查询count,avg…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2group-by"><span class="toc-text"> 4. 分组查询group by</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2order-by"><span class="toc-text"> 5. 排序查询order by</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2limit"><span class="toc-text"> 6. 分页查询limit</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-2"><span class="toc-text"> 注意事项</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E6%93%8D%E4%BD%9C"><span class="toc-text"> 实际操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-dcl"><span class="toc-text"> 4. DCL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%AE%A1%E7%90%86%E7%94%A8%E6%88%B7"><span class="toc-text"> 1. 管理用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-text"> 2. 权限控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-mysql%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text"> 5. mysql正则表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E5%87%BD%E6%95%B0"><span class="toc-text"> 6.函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-text"> 1. 字符串函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-text"> 2. 数值函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-text"> 3. 日期函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%87%BD%E6%95%B0"><span class="toc-text"> 4. 系统信息函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%B5%81%E7%A8%8B%E5%87%BD%E6%95%B0"><span class="toc-text"> 5. 流程函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E7%BA%A6%E6%9D%9F"><span class="toc-text"> 7. 约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%B8%B8%E8%A7%81%E7%BA%A6%E6%9D%9F"><span class="toc-text"> 1. 常见约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9Fforeign-key"><span class="toc-text"> 2. 外键约束foreign key</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%A4%96%E9%94%AE"><span class="toc-text"> 1. 创建外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E5%A4%96%E9%94%AE"><span class="toc-text"> 2. 查看外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%BF%AE%E6%94%B9%E5%92%8C%E5%88%A0%E9%99%A4%E5%A4%96%E9%94%AE"><span class="toc-text"> 3. 修改和删除外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%90%AF%E7%94%A8%E6%88%96%E7%A6%81%E7%94%A8%E5%A4%96%E9%94%AE"><span class="toc-text"> 4. 启用或禁用外键</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%87%AA%E5%8A%A8%E5%A2%9E%E9%95%BF"><span class="toc-text"> 3. 自动增长</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 8. 多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A4%9A%E8%A1%A8%E5%85%B3%E7%B3%BB"><span class="toc-text"> 1. 多表关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%90%88%E5%B9%B6%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 2. 合并查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 3. 内连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 4. 外连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 5. 自连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2unionunion-all"><span class="toc-text"> 6. 联合查询union，union all</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 7. 子查询(嵌套查询)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%A0%87%E9%87%8F%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 1. 标量子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%97%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 2. 列子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 3. 行子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%A1%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 4. 表子查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E8%A7%86%E5%9B%BE%E4%B8%8E%E7%B4%A2%E5%BC%95"><span class="toc-text"> 9. 视图与索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%A7%86%E5%9B%BE"><span class="toc-text"> 1. 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%A7%86%E5%9B%BE%E5%88%9B%E5%BB%BA"><span class="toc-text"> 1. 视图创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%A7%86%E5%9B%BE%E7%AE%A1%E7%90%86"><span class="toc-text"> 2. 视图管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95"><span class="toc-text"> 2. 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%B4%A2%E5%BC%95%E5%88%9B%E5%BB%BA"><span class="toc-text"> 1. 索引创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95%E7%AE%A1%E7%90%86"><span class="toc-text"> 2. 索引管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86"><span class="toc-text"> 10. 数据库安全管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7"><span class="toc-text"> 1. 添加用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-text"> 2. 用户管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-text"> 3. 权限管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86"><span class="toc-text"> 4. 角色管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%B0%81%E9%94%81"><span class="toc-text"> 11. 数据库并发控制与封锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E6%80%A7%E7%9A%84%E5%90%AB%E4%B9%89"><span class="toc-text"> 1. 数据库并发性的含义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BA%8B%E5%8A%A1%E5%8F%8A%E5%85%B6%E6%80%A7%E8%B4%A8"><span class="toc-text"> 2. 事务及其性质</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-mysql%E6%94%AF%E6%8C%814%E7%A7%8D%E4%BA%8B%E5%8A%A1%E6%A8%A1%E5%BC%8F"><span class="toc-text"> 1. Mysql支持4种事务模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%80%A7%E8%B4%A8%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7acid"><span class="toc-text"> 2. 事务的性质（四大特性ACID）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E7%9A%84%E6%A8%A1%E5%BC%8F"><span class="toc-text"> 3. 用户定义的模式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%9A%84%E4%B8%8D%E4%B8%80%E8%87%B4%E6%80%A7"><span class="toc-text"> 3. 并发控制与数据的不一致性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-text"> 4. 事务的隔离级别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E6%80%A7%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text"> 5. 事务隔离性的实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%B0%81%E9%94%81%E5%8F%8A%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-text"> 6. 封锁及封锁协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B0%81%E9%94%81%E7%B2%92%E5%BA%A6"><span class="toc-text"> 1. 封锁粒度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B0%81%E9%94%81%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 2. 封锁类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-text"> 3. 封锁协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%AD%BB%E9%94%81%E5%92%8C%E6%B4%BB%E9%94%81"><span class="toc-text"> 4. 死锁和活锁</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0"><span class="toc-text"> 12. 存储过程与函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%9A%E7%95%8C%E7%AC%A6%E4%B8%8E%E8%AF%AD%E5%8F%A5%E5%9D%97"><span class="toc-text"> 1. 定界符与语句块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-text"> 2. 变量定义与使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E8%B0%83%E7%94%A8"><span class="toc-text"> 3. 存储过程的创建和调用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA"><span class="toc-text"> 1. 创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E4%BF%AE%E6%94%B9%E7%89%B9%E6%80%A7%E5%88%A0%E9%99%A4"><span class="toc-text"> 2. 查看，修改特性，删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-text"> 4. 存储过程相关函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-text"> 5. 用户自定义函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%B8%B8%E6%A0%87-cursor"><span class="toc-text"> 6. 游标 cursor</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E5%92%8C%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-text"> 13. 数据库备份还原和日志管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="toc-text"> 1. 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-mysqldump%E5%91%BD%E4%BB%A4%E5%A4%87%E4%BB%BD"><span class="toc-text"> 2. mysqldump命令备份</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F"><span class="toc-text"> 3. 备份还原</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-mysql%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-text"> 4. mysql日志管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97"><span class="toc-text"> 1. 错误日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97"><span class="toc-text"> 2. 二进制日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-text"> 3. 慢查询日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%80%9A%E7%94%A8%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-text"> 4. 通用日志管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E8%8B%B1%E5%AF%B9%E7%85%A7"><span class="toc-text"> 中英对照</span></a></li></ol></li></ol>
      </div>
    </article>
  
  
  <article class="card card-content categories-widget">
    <div class="categories-card">
  <div class="categories-header">
    <i 
      class="iconfont icon-fenlei" 
      style="padding-right: 2px;">
    </i>分类
  </div>
  <div class="categories-list">
    
      <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">
        <div class="categories-list-item">
          计算机基础
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
      <a href="/categories/%E6%B5%8B%E8%AF%95/">
        <div class="categories-list-item">
          测试
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
      <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/">
        <div class="categories-list-item">
          计算机语言基础
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
      <a href="/categories/%E5%A4%A7%E4%B8%80/">
        <div class="categories-list-item">
          大一
          <span class="categories-list-item-badge">2</span>
        </div>
      </a>
    
      <a href="/categories/%E5%A4%A7%E4%BA%8C/">
        <div class="categories-list-item">
          大二
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
  </div>
</div>
  </article>
  
  <article class="card card-content tags-widget">
    <div class="tags-card">
  <div class="tags-header">
    <i 
      class="iconfont icon-biaoqian" 
      style="padding-right: 2px;">
    </i>热门标签
  </div>
  <div class="tags-list">
    
      <a 
        href="/tags/python/" 
        title="python">
        <div class="tags-list-item">python</div>
      </a>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
            <main class="main-column">
              
<article class="card card-content">
  <header>
    <h1 class="post-title">
      数据库原理mysql版
    </h1>
  </header>
  <div class="post-meta post-show-meta">
    <time datetime="2023-08-24T07:11:21.000Z">
      <i 
        class="iconfont icon-calendar" 
        style="margin-right: 2px;">
      </i>
      <span>2023-08-24</span>
    </time>
    
      <span class="dot"></span>
      
        <a 
          href="/categories/%E5%A4%A7%E4%BA%8C/" 
          class="post-meta-link">
          大二
        </a>
      
    
    
      <span class="dot"></span>
      <span>15.1k 字</span>
    
  </div>
  
  </header>
  <div 
    id="section" 
    class="post-content">
    <h1 id="数据库原理"><a class="markdownIt-Anchor" href="#数据库原理"></a> 数据库原理</h1>
<p>By：jkloli</p>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Buildings-Lei/mysql_note/blob/main/README.md">mysql_note/README.md at main · Buildings-Lei/mysql_note · GitHub</a></p>
<p><a target="_blank" rel="noopener" href="https://dhc.pythonanywhere.com/article/public/1/#h4-u6743u9650u63A7u5236">MySQL - 智云知识 (dhc.pythonanywhere.com)</a></p>
<p><a target="_blank" rel="noopener" href="http://t.csdn.cn/jM0hE">http://t.csdn.cn/jM0hE</a>  CiCi喜之郎</p>
<p><a target="_blank" rel="noopener" href="http://t.csdn.cn/XolDf">http://t.csdn.cn/XolDf</a> 粉红色的Pig</p>
<p>…</p>
<h2 id="0-问题解决"><a class="markdownIt-Anchor" href="#0-问题解决"></a> 0. 问题解决</h2>
<ol>
<li>
<p>mysql命令行不要忘了<code>;</code></p>
</li>
<li>
<p>mysql命令行注释<code>-- </code></p>
</li>
<li>
<p>zerofill要在not null前面</p>
</li>
<li>
<p>mysql中``用于引用数据库对象，防止歧义。''用于引用字符串对象。</p>
</li>
<li>
<p>''空串不是null</p>
</li>
<li>
<p>给字符类型赋值，右侧一定要打双引号或单引号</p>
</li>
<li>
<p>同一个数据库中表名不能重复。</p>
</li>
<li>
<p>条件判断时逻辑判断</p>
</li>
</ol>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 不等于其中一个就行</span>
<span class="token keyword">select</span> sno <span class="token keyword">from</span> s <span class="token keyword">where</span>  s<span class="token punctuation">.</span>sno<span class="token operator">!=</span><span class="token keyword">any</span><span class="token punctuation">(</span><span class="token keyword">select</span> sc<span class="token punctuation">.</span>sno  <span class="token keyword">from</span> sc<span class="token punctuation">)</span>  <span class="token keyword">order</span> <span class="token keyword">by</span> sno <span class="token keyword">asc</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 不等于任何一个</span>
<span class="token keyword">select</span> sno <span class="token keyword">from</span> s <span class="token keyword">where</span>  s<span class="token punctuation">.</span>sno<span class="token operator">!=</span><span class="token keyword">all</span><span class="token punctuation">(</span><span class="token keyword">select</span> sc<span class="token punctuation">.</span>sno  <span class="token keyword">from</span> sc<span class="token punctuation">)</span>  <span class="token keyword">order</span> <span class="token keyword">by</span> sno <span class="token keyword">asc</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> sno <span class="token keyword">from</span> s <span class="token keyword">where</span> <span class="token operator">not</span> s<span class="token punctuation">.</span>sno<span class="token operator">=</span><span class="token keyword">any</span><span class="token punctuation">(</span><span class="token keyword">select</span> sc<span class="token punctuation">.</span>sno  <span class="token keyword">from</span> sc<span class="token punctuation">)</span>  <span class="token keyword">order</span> <span class="token keyword">by</span> sno <span class="token keyword">asc</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> sno <span class="token keyword">from</span> s <span class="token keyword">where</span>  s<span class="token punctuation">.</span>sno <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sc<span class="token punctuation">.</span>sno  <span class="token keyword">from</span> sc<span class="token punctuation">)</span>  <span class="token keyword">order</span> <span class="token keyword">by</span> sno <span class="token keyword">asc</span><span class="token punctuation">;</span>
</code></pre>
<ol start="9">
<li>mysql数据库备份记得用cmd，而不是power shell</li>
<li>cmd记得chcp 65001，防止中文字符串乱码</li>
</ol>
<h2 id="1-环境配置"><a class="markdownIt-Anchor" href="#1-环境配置"></a> 1. 环境配置</h2>
<p>0 系统是win11</p>
<p>1 先安装navicat，mysql。(知乎，csdn教程)</p>
<p>2 配置用户和系统环境变量（mysql.exe路径），直接置顶</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230913105834716.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230913105834716.png" class="lozad post-image"></p>
<p>3 windows以管理员方式开终端</p>
<pre class=" language-bash"><code class="language-bash">net stop MySQL80 
<span class="token comment" spellcheck="true">#停止服务</span>
net start MySQL80 
<span class="token comment" spellcheck="true">#开启服务</span>
chcp 65001 
<span class="token comment" spellcheck="true">#临时改命令行编码为utf-8</span>
mysql -h <span class="token string">"127.0.0.1"</span> -uroot -p  
<span class="token comment" spellcheck="true">#登录MYSQL</span>
mysql<span class="token operator">></span>ALTER USER <span class="token string">'root'</span>@<span class="token string">'localhost'</span> IDENTIFIED BY <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#修改用户密码为123456</span>
mysql<span class="token operator">></span> <span class="token keyword">exit</span> 
<span class="token comment" spellcheck="true">#退出mysql</span>
net stop MySQL80 
<span class="token comment" spellcheck="true">#停止服务</span>
</code></pre>
<h2 id="2-概述"><a class="markdownIt-Anchor" href="#2-概述"></a> 2. 概述</h2>
<h3 id="1-一些概念"><a class="markdownIt-Anchor" href="#1-一些概念"></a> 1. 一些概念</h3>
<h4 id="比较细碎的1"><a class="markdownIt-Anchor" href="#比较细碎的1"></a> 比较细碎的1</h4>
<p>从数据管理角度分析，数据库的发展可以分为三个阶段：</p>
<blockquote>
<p>人工管理阶段 20世纪50年代中期之前</p>
</blockquote>
<blockquote>
<p>文件系统阶段 20世纪50年代中期到60年代中期</p>
</blockquote>
<blockquote>
<p>数据库系统阶段 20世纪60年代后期</p>
</blockquote>
<p><strong>数据</strong>(Data)：描述事物的符号记录。数据与语义是分不可开的。</p>
<p><strong>数据库</strong>(DataBase)：是长期存储在计算机内，有组织，可共享的大量数据的集合。</p>
<p>​	特点：较小的冗杂度，较高的数据独立性和多扩展性。</p>
<p><strong>数据库管理系统</strong>（DataBase Management System，DBMS）：位于用户应用与操作系统之间的一层<strong>数据管理软件</strong>。</p>
<p><strong>数据库系统</strong>（DBS）：是由数据库，数据库管理系统（及应用开发工具），应用程序和数据库管理员组成的存储，管理，处理和维护数据的系统。</p>
<p>​	特点：1. 数据结构化 2. 数据的共享性高，冗余度低且易扩充 3. 数据独立性高 4. 数据由数据库管理系统统一管理和控制。</p>
<h4 id="信息世界基本概念"><a class="markdownIt-Anchor" href="#信息世界基本概念"></a> 信息世界基本概念</h4>
<p><strong>实体</strong>（行/记录/元组）：是客观存在并可以相互区别的事物，对应数据表中的一行“记录”。如：“张三”。</p>
<p><strong>属性</strong>（列/字段）：是事物本身固有的性质，对应数据表中的“字段”或“列”。如：“姓名”。</p>
<p><strong>码(key)</strong>：唯一标识实体的属性集。主键也叫主码。如：学生(学号(主键),姓名,班级)。</p>
<p><strong>实体型</strong>：用实体名及其属性名集来抽象和刻画同类实体。如：学生(学号,姓名)</p>
<p><strong>实体集</strong>：同一类型实体的集合。如：全体同学。</p>
<p><strong>联系</strong>：一对一，一对多，多对多。</p>
<h4 id="数据模型"><a class="markdownIt-Anchor" href="#数据模型"></a> 数据模型</h4>
<p><strong>数据模型</strong>：分为概念模型(层次模型)，逻辑模型，物理模型。</p>
<p>​	逻辑模型：按计算机系统的观点对数据建模，用于DBMS实现。</p>
<p>​    物理模型：描述数据在系统内(磁盘上)的表达方式和存储方式。</p>
<p><strong>数据模型的组成要素</strong>：数据结构，数据操作，数据的完整性约束条件。</p>
<p><strong>数据独立性</strong>：物理独立性，逻辑独立性。</p>
<p>​	物理独立性：用户的应用程序与数据库中数据的物理存储是独立的。比如内模式。</p>
<p>​	逻辑独立性：用户的应用程序与数据库的逻辑结构是相互独立的。比如外模式。</p>
<p><strong>第一代数据模型</strong>：层次模型(树状结构)，网状模型(网状)</p>
<p><strong>第二代数据模型</strong>：关系模型</p>
<h4 id="比较细碎的2"><a class="markdownIt-Anchor" href="#比较细碎的2"></a> 比较细碎的2</h4>
<p><strong>关系模型</strong>：建立在集合代数基础上的数据模型。</p>
<p>​	术语：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>关系名(表名)</td>
<td>关系模式(表头)</td>
<td>关系(二维表)</td>
</tr>
<tr>
<td>元组(记录/行)</td>
<td>属性(列)</td>
<td>属性名(列名)</td>
</tr>
<tr>
<td>属性值(列值)</td>
<td>分值(一条记录中的一个列值)</td>
<td>非规范关系(表中有表)</td>
</tr>
</tbody>
</table>
<p><strong>关系的完整性约束条件</strong>:实体完整性，参照完整性，用户定义完整性。</p>
<p>​	实体完整性：主码非空且不重复。</p>
<p>​	参照完整性：外键不为空(或均为空值)。</p>
<p>​	用户定义完整性：用户定义的完整性约束条件。</p>
<p><strong>三级模式结构</strong>：外模式，模式，内模式。</p>
<p>​	外模式可以多个，模式和内模式只能一个。</p>
<p><strong>数据表与数据库</strong></p>
<p>数据表就是记录的集合 。</p>
<p>数据库就是数据表、数据库关系和数据库关系对象的集合。</p>
<p>在数据库连接中，默认的数据库：</p>
<p>information_schema：提供了访问数据库元数据的方式。</p>
<p>mysql：是mysql的核心数据库。</p>
<p>performance_schema ：主要用于收集数据库服务器性能参数。</p>
<p>test ： mysql创建的测试库。</p>
<p><strong>笛卡尔乘积</strong></p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/47dd808f6d084db5b45a8d1c44464742.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/47dd808f6d084db5b45a8d1c44464742.png" class="lozad post-image"></p>
<h3 id="2-e-r图"><a class="markdownIt-Anchor" href="#2-e-r图"></a> 2. E-R图</h3>
<p>E-R图，也称为实体关系图，用于显示实体集之间的关系。</p>
<p><strong>实体：</strong> 用矩形框表示，将实体名写在框内。</p>
<p><strong>属性：</strong> 用椭圆框表示，将属性名写在框内，用连线将实体与属性连接。</p>
<p><strong>联系：</strong> 用菱形框表示，将联系名写在框内，用连线将相关的实体连接，并在连线旁标注联系类型(一 0 对 一 “1：1”、一对多 “1：n”、多对多 “n：m”)。</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/39746484019a058d56164505ab6607a4-1696489027314-2.jpeg" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/39746484019a058d56164505ab6607a4-1696489027314-2.jpeg" class="lozad post-image"></p>
<h3 id="3-数据库类型"><a class="markdownIt-Anchor" href="#3-数据库类型"></a> 3. 数据库类型</h3>
<p>在文件中读写数据速度相对较慢，所以现在我们使用关系型数据库管理系统（RDBMS）来存储和管理的大数据量。</p>
<p>数据库可以分为<strong>关系型数据库</strong>和<strong>非关系型数据库</strong>。</p>
<p>所谓的关系型数据库，是建立在关系模型基础上的数据库，借助于集合代数等数学概念和方法来处理数据库中的数据。</p>
<p>RDBMS即关系数据库管理系统(Relational Database Management System)的缩写。</p>
<p>特点：</p>
<ol>
<li>
<p>· 数据以表格的形式出现</p>
</li>
<li>
<p>· 每行为各种记录名称</p>
</li>
<li>
<p>· 每列为记录名称所对应的数据域</p>
</li>
<li>
<p>· 许多的行和列组成一张表</p>
</li>
<li>
<p>· 若干的表组成database</p>
</li>
</ol>
<p>关系型数据库：表与表之间存在对应关系。</p>
<p>非关系型数据库：表之间不存在关系，数据独立，随便存。</p>
<h3 id="4-常见的数据库管理系统"><a class="markdownIt-Anchor" href="#4-常见的数据库管理系统"></a> 4. 常见的数据库管理系统</h3>
<p>oracle:在全球范围内市场份额占据32%</p>
<p>sql server: 在我国，.net平台和sql server数据库应用也极其广泛</p>
<p>Sybase: 广泛应用于我国的大中型应用软件中</p>
<p>IBM/DB2:在OS/2和windows系统中应用广泛</p>
<p>mysql:简单，开源，功能强大</p>
<h3 id="5-mysql介绍"><a class="markdownIt-Anchor" href="#5-mysql介绍"></a> 5. MySQL介绍</h3>
<p>​	MySQL是最流行的关系型数据库管理系统，在WEB应用方面MySQL是最好的RDBMS(Relational Database Management System：关系数据库管理系统)应用软件之一。由瑞典MySQL AB公司开发，目前属于Oracle公司。MySQL是一种关联数据库管理系统，关联数据库将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性。</p>
<ul>
<li>
<p>Mysql是开源的，所以你不需要支付额外的费用。</p>
</li>
<li>
<p>Mysql支持大型的数据库。可以处理拥有上千万条记录的大型数据库。</p>
</li>
<li>
<p>MySQL使用标准的SQL数据语言形式。</p>
</li>
<li>
<p>Mysql可以允许于多个系统上，并且支持多种语言。这些编程语言包括C、C++、Python、Java、Perl、PHP、Eiffel、Ruby和Tcl等。</p>
</li>
<li>
<p>MySQL支持大型数据库，支持5000万条记录的数据仓库，32位系统表文件最大可支持4GB，64位系统支持最大的表文件为8TB。</p>
</li>
</ul>
<h3 id="6-sql概述"><a class="markdownIt-Anchor" href="#6-sql概述"></a> 6. SQL概述</h3>
<p>SQL(Structured Query Language),即结构化查询语言，是高级的非过程化编程语言。SQL是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系型数据库系统。</p>
<p><strong>SQL分类</strong>：</p>
<p>数据查询语言（Data Query Language） DQL</p>
<p>数据操纵语言（Manipulation）DML</p>
<p>数据定义语言（Definition）DDL</p>
<p>数据控制语言（Control）DCL</p>
<p>实际上不同数据库系统之间的SQL<strong>不能完全相互通用</strong>。</p>
<h2 id="2-navicat基础操作"><a class="markdownIt-Anchor" href="#2-navicat基础操作"></a> 2. navicat基础操作</h2>
<h3 id="1-使用navicat创建数据库"><a class="markdownIt-Anchor" href="#1-使用navicat创建数据库"></a> 1. 使用navicat创建数据库</h3>
<p>1.先在命令行启动服务net start MySQL80   (一般已经启动了)</p>
<p>2.然后开navicat，连接测试，然后点确定。</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230913115338814.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230913115338814.png" class="lozad post-image"></p>
<p>3.右键连接名，选新建数据库（或命令行界面）</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230913234054734.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230913234054734.png" class="lozad post-image"></p>
<p>4.选阉割版的utf-8字符集，下面那个选大小写不敏感。</p>
<ul>
<li>utf8mb3 ：阉割过的 utf8 字符集，只使用1～3个字节表示字符。</li>
<li>utf8mb4 ：正宗的 utf8 字符集，使用1～4个字节表示字符。</li>
</ul>
<p><strong>在utf8mb4下，英文占1个字符，中文3个，特殊符号4个.</strong></p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230913234700537-1696489079345-5.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230913234700537-1696489079345-5.png" class="lozad post-image"></p>
<h3 id="2-修改字段属性"><a class="markdownIt-Anchor" href="#2-修改字段属性"></a> 2. 修改字段属性</h3>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/_9edbb3186f777ca2e18fb935f772814d_358742864_v2-d7f5a99c3bcd3cbdd8e6c040d8ca705c_b-1694955310018-4.jpg" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/_9edbb3186f777ca2e18fb935f772814d_358742864_v2-d7f5a99c3bcd3cbdd8e6c040d8ca705c_b-1694955310018-4.jpg" class="lozad post-image"></p>
<p>右键点击需要修改的表，选择「设计表」，然后在右侧编辑字段属性</p>
<h3 id="3-添加数据"><a class="markdownIt-Anchor" href="#3-添加数据"></a> 3. 添加数据</h3>
<p>打开表后在左下角有加号。</p>
<p>快捷键：insert添加记录，ctrl+s保存记录。</p>
<h3 id="4-查询表"><a class="markdownIt-Anchor" href="#4-查询表"></a> 4. 查询表</h3>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917205904418-1696489083096-7.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917205904418-1696489083096-7.png" class="lozad post-image"></p>
<h3 id="5-备份和还原数据库"><a class="markdownIt-Anchor" href="#5-备份和还原数据库"></a> 5. 备份和还原数据库</h3>
<ol>
<li>
<p><strong>选中要备份的数据库—&gt;右键—&gt;转储SQL文件—&gt;结构和数据</strong>：</p>
</li>
<li>
<p>成功则可以生成一个sql文件，然后在另一个空的数据库-&gt;右键</p>
</li>
</ol>
<p>-&gt;运行SQL文件。</p>
<ol start="3">
<li>数据库右键-&gt;刷新。</li>
</ol>
<h2 id="3-数据类型"><a class="markdownIt-Anchor" href="#3-数据类型"></a> 3. 数据类型</h2>
<h3 id="1-数字类型"><a class="markdownIt-Anchor" href="#1-数字类型"></a> 1. 数字类型</h3>
<p><strong>整数类型</strong></p>
<p>二进制,有符号数,首位为1的是负数,首位为0的是正数。</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>字节数</th>
<th>无符号数的取值范围</th>
<th>有符号数的取值范围</th>
</tr>
</thead>
<tbody>
<tr>
<td>TINYINT</td>
<td>1</td>
<td>0~255(2^8-1)</td>
<td>- 128 ~ 127</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2</td>
<td>0~65 535</td>
<td>- 32 768 ~ 32 767</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>3</td>
<td>0~16 777 215</td>
<td>- 8 388 608 ~ 8 388 607</td>
</tr>
<tr>
<td>INT</td>
<td>4</td>
<td>0~4 294 967 295</td>
<td>- 2 147 483 648 ~ 2 147 483 647</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8</td>
<td>0 ~ 18 446 744 073 709 551 615</td>
<td>- 9 223 372 036 854 775 808 ~ 9 223 372 036 854 775 807</td>
</tr>
</tbody>
</table>
<p><strong>浮点数</strong></p>
<p>比如：price double(5,2)可以表示-222.22</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>字节数</th>
<th>负数的取值范围</th>
<th>非负数的取值范围</th>
</tr>
</thead>
<tbody>
<tr>
<td>FLOAT</td>
<td>4</td>
<td>－3.402 823 466E + 38 ～－1.175 494 351E－38</td>
<td>0 和 1.175 494 351E－38～3.402 823 466E+38</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>8</td>
<td>－1.797 693 134 862 315 7E + 308 ~ －2. 225 073 858 507 201 4E－308</td>
<td>0 和 2.225 073 858 507 201 4E－308～1.797 693 134 862 315 7E + 308</td>
</tr>
</tbody>
</table>
<p><strong>定点数类型</strong></p>
<p>包括decimal和numeric。</p>
<p>DECIMAL(M,D) 设置<strong>精度（总位数）和标度（小数点后位数）</strong>。</p>
<p>其中，M表示数字总位数（不包括“.”和“-”)，最大值为65，默认值为10；D最大值为30，默认值为0。</p>
<p>例如，DECIMAL(5，2) 表示的取值范围是 －999.99～999.99。</p>
<ul>
<li>
<p>若小数部分超出范围，会进行四舍五入，并出现 Data truncated(数据截断) 警告。</p>
</li>
<li>
<p>若整数部分超出范围，会报错。</p>
</li>
</ul>
<h3 id="2-事件和日期类型"><a class="markdownIt-Anchor" href="#2-事件和日期类型"></a> 2. 事件和日期类型</h3>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>取值范围</th>
<th>日期格式</th>
<th>零 值</th>
</tr>
</thead>
<tbody>
<tr>
<td>YEAR</td>
<td>1901 ~ 2155</td>
<td>YYYY</td>
<td>0000</td>
</tr>
<tr>
<td>DATE</td>
<td>1000-01-01 ~ 9999-12-3</td>
<td>YYYY-MM-DD</td>
<td>0000-00-00</td>
</tr>
<tr>
<td>TIME</td>
<td>－838:59:59 ~ 838:59:59</td>
<td>HH:MM:SS</td>
<td>00:00:00</td>
</tr>
<tr>
<td>DATETIME</td>
<td>1000-01-01 00:00:00 ~ 9999-12-31 23:59:59</td>
<td>YYYY-MM-DD HH:MM:SS</td>
<td>0000-00-00 00:00:00</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>1970-01-01 00:00:01 ~ 2038-01-19 03:14:07</td>
<td>YYYY-MM-DD HH:MM:SS</td>
<td>0000-00-00 00:00:00</td>
</tr>
</tbody>
</table>
<p>如果插入的数值不合法，系统会自动将对应的零值插入数据库中。</p>
<ul>
<li>
<p>用1901或&quot;1901&quot;表示1901年</p>
</li>
<li>
<p>若是YY表示年，其中<code>'00'~'69'</code> 的值会被转换为<code>2000~2069</code>的值，<code>70'~'99'</code> 的值会被转换为 <code>1970~1999</code> 的值</p>
</li>
<li>
<p>当使用 YEAR 类型时，一定要区分 <code>'0'</code> 和 <code>0</code>。因为字符串格式的 <code>'0'</code> 表示的 YEAR 值是 <code>2000</code>，而数字格式的 <code>0</code>表示的 YEAR 值是 <code>0000</code> 。</p>
</li>
</ul>
<h3 id="3-字符串类型"><a class="markdownIt-Anchor" href="#3-字符串类型"></a> 3. 字符串类型</h3>
<p><strong>文本字符串</strong></p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>类型说明</th>
<th>储存需求</th>
</tr>
</thead>
<tbody>
<tr>
<td>CHAR(M)</td>
<td>固定长度字符串</td>
<td>M个字符，M区间[0,255]</td>
</tr>
<tr>
<td>VARCHAR(M)</td>
<td>可变长度字符串</td>
<td>L+1个字节。M取值与字符集有关，不超过65535字节</td>
</tr>
<tr>
<td>TINYTEXT</td>
<td>非常小的</td>
<td>L+1字节，L&lt;2^8</td>
</tr>
<tr>
<td>TEXT</td>
<td>小的非二进制字符串</td>
<td>L+2字节，L&lt;2^16</td>
</tr>
<tr>
<td>MEDIUMTEXT</td>
<td>中等大小的</td>
<td>L+3字节，L&lt;2^24</td>
</tr>
<tr>
<td>LONGTEXT</td>
<td>非常大的</td>
<td>L+4字节，L&lt;2^32</td>
</tr>
<tr>
<td>ENUM(‘value1’,‘v2’)</td>
<td>枚举类型</td>
<td>1或2个字节，取决于枚举值的个数（&lt;=65535）</td>
</tr>
<tr>
<td>SET(‘v1’,‘v2’)</td>
<td>一个集合，字符串对象可以有零个或多个集合成员</td>
<td>1,2,3,4或8个字节，取决于set成员数目(最多64)</td>
</tr>
</tbody>
</table>
<p>varchar</p>
<ul>
<li>varchar(10)插入超出10个会报错。</li>
<li>varchar(4)可以插入&quot;abcd&quot;</li>
<li>需要额外的1个或2个字节记录字符串的长度，字符串长度小于255字节使用1个字节，否则使用2个。</li>
</ul>
<p>当定义一个字段类型为 varchar(10)，插入的值为&quot;abc&quot;这一字符串时，那么实际存储大小为3个字节，除此之外，varchar还需要使用1个额外字节（因为‘abc’字节数＜255）来记录字符串的长度。</p>
<p>char</p>
<ul>
<li>长度不够时内部储存用空格填充。</li>
<li>name char(3)可以存放&quot;abc&quot;</li>
<li>char(3)超过三个字符会报错。</li>
</ul>
<p>另外</p>
<ul>
<li>在创建表时，char和varchar需要指定长度，但是text，tinytext，mediumtext，longtext数据类型不需要指定长度。</li>
</ul>
<p><strong>二进制字符串</strong></p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>说明</th>
<th>储存需求</th>
</tr>
</thead>
<tbody>
<tr>
<td>BIT(M)</td>
<td>位数据类型</td>
<td>(M+7)/8字节，M区间[1,64]</td>
</tr>
<tr>
<td>BINARY(M)</td>
<td>固定长度的二进制字符串</td>
<td>M字节</td>
</tr>
<tr>
<td>VARBINARY(M)</td>
<td>可变长度的二进制字符串</td>
<td>M+1字节</td>
</tr>
<tr>
<td>TINYBLOB(M)</td>
<td>非常小的</td>
<td>L+1字节，L&lt;2^8</td>
</tr>
<tr>
<td>BLOB(M)</td>
<td>二进制大对象（Binary Large Object）</td>
<td>L+2字节，L&lt;2^16</td>
</tr>
<tr>
<td>MEDIUMBLOB(M)</td>
<td>中等大小的</td>
<td>L+3字节，L&lt;2^24</td>
</tr>
<tr>
<td>LONGBLOB(M)</td>
<td>非常大的</td>
<td>L+4字节，L&lt;2^32</td>
</tr>
</tbody>
</table>
<p>BLOB一般用来存图片。</p>
<h3 id="4-json数据类型"><a class="markdownIt-Anchor" href="#4-json数据类型"></a> 4. JSON数据类型</h3>
<p>略。</p>
<h2 id="4-sql分类详解"><a class="markdownIt-Anchor" href="#4-sql分类详解"></a> 4. SQL分类详解</h2>
<h3 id="1-ddl-数据定义语言"><a class="markdownIt-Anchor" href="#1-ddl-数据定义语言"></a> 1. DDL 数据定义语言</h3>
<h4 id="1-数据库操作"><a class="markdownIt-Anchor" href="#1-数据库操作"></a> 1. 数据库操作</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#查看数据库</span>
mysql<span class="token operator">></span><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#创建数据库db1</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token number">db1</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#创建数据库并设置编码格式</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token number">db9</span> <span class="token keyword">character set</span> gb2312<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#删除数据库db1</span>
<span class="token keyword">drop</span> <span class="token keyword">database</span> <span class="token number">db1</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/*使用名为mysql数据库*/</span>
<span class="token keyword">use</span> mysql<span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">-- 显示当前所使用的数据库</span>
<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">database</span> 数据库名<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">-- 查看这个数据库的建库语句；</span>

</code></pre>
<h4 id="2-表操作重要"><a class="markdownIt-Anchor" href="#2-表操作重要"></a> 2. 表操作（重要）</h4>
<p>注意：</p>
<ol>
<li>创建表名不超过64字符，不重名(mysql表名不区分大小写)。</li>
<li>表名为mysql关键字时需要用反引号，比如<code>create</code></li>
<li>同一表中不能有重名字段。</li>
</ol>
<p><strong>显示当前数据库内所有的表名</strong><br>
<code>show tables;</code></p>
<p><strong>查看建表语句</strong><br>
<code>show create table 表名;</code></p>
<p><strong>查看user数据表的结构（主要看类型）</strong><br>
<code>desc user;</code></p>
<p><strong>创建新表</strong></p>
<p><code>create table 表名( </code></p>
<p><code>字段名 类型(长度),</code></p>
<p><code>字段名 类型(长度)</code></p>
<p><code>);</code></p>
<p><strong>添加字段：</strong><br>
<code>ALTER TABLE 表名 ADD 字段名 类型(长度) [COMMENT 注释] [约束];</code></p>
<p><strong>修改数据类型：</strong><br>
<code>ALTER TABLE 表名 MODIFY 字段名 新数据类型(长度);</code><br>
<strong>修改字段名和字段类型：</strong><br>
<code>ALTER TABLE 表名 CHANGE 旧字段名 新字段名 类型(长度) [COMMENT 注释] [约束];</code></p>
<p><strong>删除字段：</strong><br>
<code>ALTER TABLE 表名 DROP 字段名;</code></p>
<p><strong>修改表名：</strong><br>
<code>ALTER TABLE 表名 RENAME TO 新表名</code></p>
<p><strong>删除表：</strong><br>
<code>DROP TABLE [IF EXISTS] 表名;</code><br>
<strong>删除表，并重新创建该表：</strong><br>
<code>TRUNCATE TABLE 表名;</code></p>
<p><strong>实际操作</strong></p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230914160230142-1696489095723-9.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230914160230142-1696489095723-9.png" class="lozad post-image"></p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 创建新表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> teacher<span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span> <span class="token keyword">comment</span> <span class="token string">"编号"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">-- 编号 类型 主键 自增 注释表名 注释</span>
name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unique</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">-- 不重复</span>
age <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> zerofill <span class="token operator">not</span> <span class="token boolean">null</span>  <span class="token punctuation">,</span><span class="token comment" spellcheck="true">-- 宽度不够则左侧补0,非空</span>
classId <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> unsigned <span class="token keyword">default</span> <span class="token number">1</span> <span class="token comment" spellcheck="true">-- 这里不要打逗号，默认1</span>
<span class="token punctuation">)</span><span class="token keyword">engine</span><span class="token operator">=</span><span class="token keyword">innodb</span><span class="token punctuation">,</span><span class="token keyword">charset</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> teacher<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- 删除新表</span>
</code></pre>
<p>int(3)表示最大宽度（显示宽度）为3，比如666，-666。</p>
<ul>
<li>
<p>若数值的位数小于显示宽度，会填充空格，若大于显示宽度，则不影响显示结果。</p>
</li>
<li>
<p>设置零填充后，字段自动设为无符号类型，这是因为负数不能使用负填充。</p>
</li>
<li>
<p>zerofill要在not null前面</p>
</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> test2 <span class="token keyword">add</span> id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> test2 <span class="token keyword">modify</span> name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> test2 change id age <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> test2 <span class="token keyword">drop</span> age<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> test2 <span class="token keyword">rename</span> <span class="token keyword">to</span> test3<span class="token punctuation">;</span>
<span class="token keyword">truncate</span> <span class="token keyword">table</span> test3<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> test3<span class="token punctuation">;</span>
</code></pre>
<ul>
<li>注意如果已经存了char数据，修改成int参数类型会报错。</li>
<li>int类型储存的int数据可以转换成char类型。</li>
</ul>
<h3 id="2-dml数据操作语言"><a class="markdownIt-Anchor" href="#2-dml数据操作语言"></a> 2. DML（数据操作语言）</h3>
<h4 id="1-添加数据-insert"><a class="markdownIt-Anchor" href="#1-添加数据-insert"></a> 1. 添加数据 insert</h4>
<p>指定字段：<br>
<code>INSERT INTO 表名 (字段名1, 字段名2, ...) VALUES (值1, 值2, ...);</code><br>
全部字段：<br>
<code>INSERT INTO 表名 VALUES (值1, 值2, ...);</code></p>
<p>批量添加数据：<br>
<code>INSERT INTO 表名 (字段名1, 字段名2, ...) VALUES (值1, 值2, ...), (值1, 值2, ...), (值1, 值2, ...);</code><br>
<code>INSERT INTO 表名 VALUES (值1, 值2, ...), (值1, 值2, ...), (值1, 值2, ...);</code></p>
<h5 id="注意事项"><a class="markdownIt-Anchor" href="#注意事项"></a> 注意事项</h5>
<ul>
<li>字符串和日期类型数据应该包含在引号中</li>
<li>插入的数据大小应该在字段的规定范围内</li>
</ul>
<h4 id="2-更新和删除数据updatedelete"><a class="markdownIt-Anchor" href="#2-更新和删除数据updatedelete"></a> 2. 更新和删除数据update,delete</h4>
<p>修改数据：<br>
<code>UPDATE 表名 SET 字段名1 = 值1, 字段名2 = 值2, ... [ WHERE 条件 ];</code></p>
<p>删除数据：<br>
<code>DELETE FROM 表名 [ WHERE 条件 ];</code></p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"gg"</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">value</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"bfb"</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> teacher <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> teacher <span class="token keyword">set</span> name <span class="token operator">=</span> <span class="token string">'mom'</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 给字符类型赋值，右侧一定要打双引号或单引号。</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
</code></pre>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230916212109419-1696489101106-11.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230916212109419-1696489101106-11.png" class="lozad post-image"></p>
<h3 id="3-dql数据查询语言"><a class="markdownIt-Anchor" href="#3-dql数据查询语言"></a> 3. DQL（数据查询语言）</h3>
<p>关键字书写顺序</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> 字段列表
<span class="token keyword">FROM</span> 表名字段
<span class="token keyword">WHERE</span> 条件列表
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 分组字段列表
<span class="token keyword">HAVING</span> 分组后的条件列表
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 排序字段列表
<span class="token keyword">LIMIT</span> 分页参数
</code></pre>
<p>关键字执行顺序</p>
<p>FROM&gt; WHERE &gt; GROUP BY &gt;having&gt; SELECT &gt; ORDER BY &gt;limit</p>
<h4 id="1-基础查询-select"><a class="markdownIt-Anchor" href="#1-基础查询-select"></a> 1. 基础查询 select</h4>
<p>查询多个字段：<br>
<code>SELECT 字段1, 字段2, 字段3, ... FROM 表名;</code><br>
<code>SELECT * FROM 表名;</code></p>
<p>设置别名：</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token punctuation">`</span>name<span class="token punctuation">`</span> <span class="token keyword">as</span> <span class="token string">'名字'</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- 名字是别名</span>
<span class="token keyword">select</span> <span class="token punctuation">`</span>name<span class="token punctuation">`</span>  <span class="token string">'名字'</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- 只改变显示，不改字段名</span>
</code></pre>
<p>去除重复记录：<br>
<code>SELECT DISTINCT 字段列表 FROM 表名;</code></p>
<p>转义：</p>
<p><code>SELECT * FROM 表名 WHERE name LIKE '\_张三' ESCAPE '\'</code><br>
\ 之后的_不作为通配符</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> age <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 可以匹配_xx</span>
<span class="token keyword">select</span> name <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'\_%'</span> <span class="token punctuation">;</span>
</code></pre>
<h4 id="2-条件查询-where"><a class="markdownIt-Anchor" href="#2-条件查询-where"></a> 2. 条件查询 where</h4>
<p>语法：<br>
<code>SELECT 字段列表 FROM 表名 WHERE 条件列表;</code></p>
<p>条件：</p>
<pre class=" language-sql"><code class="language-sql"><span class="token operator">></span> <span class="token operator">>=</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;=</span> <span class="token operator">=</span> 
<span class="token operator">&lt;></span>或<span class="token operator">!=</span>
<span class="token operator">between</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">and</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment" spellcheck="true">-- 比如between 10 and 20,在[10,20]区间内</span>
<span class="token operator">in</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">-- 多选一,比如in(20,35,40)</span>
<span class="token operator">like</span> 占位符 <span class="token comment" spellcheck="true">-- 模糊匹配</span>
<span class="token operator">is</span> <span class="token boolean">null</span> <span class="token comment" spellcheck="true">-- 是空</span>
<span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token comment" spellcheck="true">-- 非空</span>
<span class="token operator">&amp;&amp;</span> 或 <span class="token operator">and</span> <span class="token comment" spellcheck="true">-- 且</span>
<span class="token operator">||</span> 或 <span class="token operator">or</span> <span class="token comment" spellcheck="true">-- 或</span>
<span class="token operator">!</span> 或 <span class="token operator">not</span> <span class="token comment" spellcheck="true">-- 非</span>
</code></pre>
<p>mysql常用通配符</p>
<ul>
<li>
<p>%表示任何字符出现任意次数（包括0次）</p>
</li>
<li>
<p>_表示匹配一个字符。</p>
</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 可以匹配abc,ABC(忽略大小写)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">from</span> test1 <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'%B%'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 可以匹配ABC(加了binary不忽略大小写)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">from</span> test1 <span class="token keyword">where</span> <span class="token keyword">binary</span> name <span class="token operator">like</span> <span class="token string">'%B%'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 不匹配a</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">from</span> test1 <span class="token keyword">where</span> <span class="token keyword">binary</span> name <span class="token operator">like</span> <span class="token string">'a_'</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="3-聚合查询countavg"><a class="markdownIt-Anchor" href="#3-聚合查询countavg"></a> 3. 聚合查询count,avg…</h4>
<p>常见聚合函数：</p>
<table>
<thead>
<tr>
<th style="text-align:left">函数</th>
<th style="text-align:left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">count()</td>
<td style="text-align:left">统计数量</td>
</tr>
<tr>
<td style="text-align:left">max()</td>
<td style="text-align:left">最大值</td>
</tr>
<tr>
<td style="text-align:left">min()</td>
<td style="text-align:left">最小值</td>
</tr>
<tr>
<td style="text-align:left">avg()</td>
<td style="text-align:left">平均值</td>
</tr>
<tr>
<td style="text-align:left">sum()</td>
<td style="text-align:left">求和</td>
</tr>
</tbody>
</table>
<p>例：</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>id <span class="token keyword">from</span> test1 <span class="token keyword">where</span> age <span class="token operator">between</span> <span class="token number">1</span> <span class="token operator">and</span> <span class="token number">5</span> <span class="token keyword">having</span> id<span class="token operator">></span><span class="token number">3</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- count(*)id等价于count(id)</span>
</code></pre>
<h4 id="4-分组查询group-by"><a class="markdownIt-Anchor" href="#4-分组查询group-by"></a> 4. 分组查询group by</h4>
<p>相关函数：avg平均,count计数,sum总和,max最大,min最小</p>
<p>group by分组之后可能出现一个单元格有多个值并报错。比如分组后name为aa的一行中，id同时有1和2。一般需要用聚合函数或group_concat解决。</p>
<p>语法：<br>
<code>SELECT 字段列表 FROM 表名 [ WHERE 条件 ] GROUP BY 分组字段名 [ HAVING 分组后的过滤条件 ];</code></p>
<p>例如：</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span><span class="token punctuation">`</span>name<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">`</span>age<span class="token punctuation">`</span> <span class="token keyword">from</span> test1 <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token punctuation">`</span>age<span class="token punctuation">`</span><span class="token punctuation">;</span>
</code></pre>
<p>where 和 having 的区别：</p>
<ul>
<li>执行时机不同：where是分组之前进行过滤，不满足where条件不参与分组；having是分组后对结果进行过滤。</li>
<li>判断条件不同：where不能对聚合函数进行判断，而having可以。</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> s<span class="token punctuation">.</span>sno <span class="token keyword">as</span> <span class="token string">"学号"</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>sn <span class="token keyword">as</span> <span class="token string">"姓名"</span><span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">"平均成绩"</span> <span class="token keyword">from</span> s<span class="token punctuation">,</span>sc<span class="token punctuation">,</span><span class="token number">c</span>  <span class="token keyword">where</span>  sc<span class="token punctuation">.</span>sno<span class="token operator">=</span>s<span class="token punctuation">.</span>sno    <span class="token keyword">group</span> <span class="token keyword">by</span> sc<span class="token punctuation">.</span>sno <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">80</span> <span class="token keyword">order</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>sno <span class="token keyword">asc</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="5-排序查询order-by"><a class="markdownIt-Anchor" href="#5-排序查询order-by"></a> 5. 排序查询order by</h4>
<p>语法：<br>
<code>SELECT 字段列表 FROM 表名 ORDER BY 字段1 排序方式1, 字段2 排序方式2;</code></p>
<p>排序方式：</p>
<ul>
<li>ASC: 升序（默认）</li>
<li>DESC: 降序</li>
</ul>
<p><strong>注意</strong>：如果是多字段排序，当第一个字段值相同时，才会根据第二个字段进行排序</p>
<h4 id="6-分页查询limit"><a class="markdownIt-Anchor" href="#6-分页查询limit"></a> 6. 分页查询limit</h4>
<p>语法：<br>
<code>SELECT 字段列表 FROM 表名 LIMIT 起始索引, 查询记录数;</code></p>
<p>例子：</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 查询第一页数据，展示10条</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="注意事项-2"><a class="markdownIt-Anchor" href="#注意事项-2"></a> 注意事项</h5>
<ul>
<li>起始索引从0开始，起始索引 = （查询页码 - 1） * 每页显示记录数</li>
<li>分页查询是数据库的方言，不同数据库有不同实现，MySQL是LIMIT</li>
<li>如果查询的是第一页数据，起始索引可以省略，直接简写 LIMIT 100</li>
</ul>
<h4 id="实际操作"><a class="markdownIt-Anchor" href="#实际操作"></a> 实际操作</h4>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917204155472.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917204155472.png" class="lozad post-image"></p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917204222235.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917204222235.png" class="lozad post-image"></p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917213025813-1696489116426-15.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917213025813-1696489116426-15.png" class="lozad post-image"></p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917213620668-1696489120779-17.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917213620668-1696489120779-17.png" class="lozad post-image"></p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917213815673-1696489124548-19.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230917213815673-1696489124548-19.png" class="lozad post-image"></p>
<h3 id="4-dcl"><a class="markdownIt-Anchor" href="#4-dcl"></a> 4. DCL</h3>
<h4 id="1-管理用户"><a class="markdownIt-Anchor" href="#1-管理用户"></a> 1. 管理用户</h4>
<p>查询用户：</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">USE</span> mysql<span class="token punctuation">;</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre>
<p>创建用户:<br>
<code>CREATE USER '用户名'@'主机名' IDENTIFIED BY '密码';</code></p>
<p>修改用户密码：<br>
<code>ALTER USER '用户名'@'主机名' IDENTIFIED WITH mysql_native_password BY '新密码';</code></p>
<p>删除用户：<br>
<code>DROP USER '用户名'@'主机名';</code></p>
<ul>
<li>主机名可以使用 % 通配</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 只能主机localhost访问</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token string">'user2'</span>@'localhost<span class="token string">' identified by '</span><span class="token number">123456</span>'<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 任意主机访问</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token string">'user3'</span>@'<span class="token operator">%</span><span class="token string">' identified by '</span><span class="token number">123456</span><span class="token string">';
create user '</span>user4<span class="token string">' identified by '</span><span class="token number">123456</span>'<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 修改密码</span>
<span class="token keyword">alter</span> <span class="token keyword">user</span> <span class="token string">'user2'</span>@'localhost<span class="token string">' identified with mysql_native_password by '</span><span class="token number">123</span>'<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 删除用户</span>
<span class="token keyword">drop</span> <span class="token keyword">user</span> <span class="token string">'user2'</span><span class="token variable">@'localhost'</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="2-权限控制"><a class="markdownIt-Anchor" href="#2-权限控制"></a> 2. 权限控制</h4>
<p>常用权限：</p>
<table>
<thead>
<tr>
<th style="text-align:left">权限</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ALL, ALL PRIVILEGES</td>
<td style="text-align:left">所有权限</td>
</tr>
<tr>
<td style="text-align:left">SELECT</td>
<td style="text-align:left">查询数据</td>
</tr>
<tr>
<td style="text-align:left">INSERT</td>
<td style="text-align:left">插入数据</td>
</tr>
<tr>
<td style="text-align:left">UPDATE</td>
<td style="text-align:left">修改数据</td>
</tr>
<tr>
<td style="text-align:left">DELETE</td>
<td style="text-align:left">删除数据</td>
</tr>
<tr>
<td style="text-align:left">ALTER</td>
<td style="text-align:left">修改表</td>
</tr>
<tr>
<td style="text-align:left">DROP</td>
<td style="text-align:left">删除数据库/表/视图</td>
</tr>
<tr>
<td style="text-align:left">CREATE</td>
<td style="text-align:left">创建数据库/表</td>
</tr>
<tr>
<td style="text-align:left">USAGE</td>
<td style="text-align:left">不优先</td>
</tr>
</tbody>
</table>
<p>查询权限：</p>
<p><code>show grants for '用户名'@'主机名';</code></p>
<p>授予权限：</p>
<p><code>GRANT 权限列表 ON 数据库名.表名 TO '用户名'@'主机名';</code></p>
<p>撤销权限：</p>
<p><code>REVOKE 权限列表 ON 数据库名.表名 FROM '用户名'@'主机名';</code></p>
<ul>
<li>多个权限用逗号分隔</li>
<li>授权时，数据库名和表名可以用 * 进行通配，代表所有</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">show</span> grants <span class="token keyword">for</span> <span class="token string">'user2'</span>@'localhost<span class="token string">';
GRANT SELECT, INSERT ON db1.test1 TO '</span>user2<span class="token string">'@'</span>localhost'<span class="token punctuation">;</span> 
<span class="token keyword">GRANT</span> <span class="token keyword">USAGE</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token punctuation">`</span>user2<span class="token punctuation">`</span><span class="token variable">@`localhost`</span><span class="token punctuation">;</span>
<span class="token keyword">revoke</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span> <span class="token keyword">on</span> <span class="token number">db1</span><span class="token punctuation">.</span>test1 <span class="token keyword">from</span> <span class="token punctuation">`</span>user2<span class="token punctuation">`</span><span class="token variable">@`localhost`</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="5-mysql正则表达式"><a class="markdownIt-Anchor" href="#5-mysql正则表达式"></a> 5. mysql正则表达式</h2>
<table>
<thead>
<tr>
<th>a{5}</th>
<th>a只能出现5次</th>
</tr>
</thead>
<tbody>
<tr>
<td>a{1,3}</td>
<td>a取值范围[1,3]</td>
</tr>
<tr>
<td>[<em>charlist</em>]</td>
<td>字符列中的任何单一字符</td>
</tr>
<tr>
<td>[^<em>charlist</em>] 或 [!<em>charlist</em>]</td>
<td>不在字符列中的任何单一字符</td>
</tr>
<tr>
<td><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></td>
<td>以charlist开头的列</td>
</tr>
<tr>
<td>X$</td>
<td>表示以字母 X 结尾的字符串。</td>
</tr>
<tr>
<td>.</td>
<td>匹配任何一个字符，包括回车、换行等</td>
</tr>
<tr>
<td>x*</td>
<td>x{0,}。星号匹配 0 个或多个字符，在它之前必须有内容。</td>
</tr>
<tr>
<td>x?</td>
<td>x{0,1}。问号匹配 0 次或 1 次。('baa?na’匹配一个a或者0个a)</td>
</tr>
<tr>
<td>x+</td>
<td>x{1,}加号匹配 1 个或多个字符，在它之前也必须有内容。</td>
</tr>
<tr>
<td>(abc)*</td>
<td>匹配任意多个abc（包括空串)</td>
</tr>
<tr>
<td>*?</td>
<td>(懒惰)重复任意次，但尽可能少重复</td>
</tr>
<tr>
<td>.*</td>
<td>(贪婪)尽可能多匹配</td>
</tr>
<tr>
<td>下面在mysql里需要两条反斜杠（大小写敏感）</td>
<td></td>
</tr>
<tr>
<td>\w</td>
<td>匹配字母或数字或下划线或汉字</td>
</tr>
<tr>
<td>\s</td>
<td>匹配任意的空白符</td>
</tr>
<tr>
<td>\d</td>
<td>匹配数字</td>
</tr>
<tr>
<td>\b</td>
<td>匹配单词的开始或结束（\blove\b匹配&quot;i love you&quot;中的love）</td>
</tr>
<tr>
<td>\W</td>
<td>匹配任意不是字母，数字，下划线，汉字的字符</td>
</tr>
<tr>
<td>\S</td>
<td>匹配任意不是空白符的字符</td>
</tr>
<tr>
<td>\D</td>
<td>匹配任意非数字的字符</td>
</tr>
<tr>
<td>\B</td>
<td>匹配不是单词开头或结束的位置</td>
</tr>
</tbody>
</table>
<ol>
<li>
<p>MySQL 中使用 <strong>REGEXP</strong> 或 <strong>NOT REGEXP</strong> 运算符 (或 RLIKE 和 NOT RLIKE) 来操作正则表达式。(regular-expression)</p>
</li>
<li>
<p>正则表达式默认不区分大小写。</p>
</li>
</ol>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 查询找到所有名称以元音开始和 ok 结束的:</span>
<span class="token keyword">SELECT</span> name <span class="token keyword">FROM</span> tb1 <span class="token keyword">WHERE</span> name <span class="token operator">REGEXP</span> <span class="token string">'^[aeiou]|ok$'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 匹配元素是1-3个a，可以匹配a,aa,aaa</span>
<span class="token keyword">SELECT</span> name <span class="token keyword">FROM</span> test1 <span class="token keyword">WHERE</span> name <span class="token operator">REGEXP</span> <span class="token string">'^a{1,3}$'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 匹配元素含有1-3个a，可以匹配aaaa</span>
<span class="token keyword">SELECT</span> name <span class="token keyword">FROM</span> test1 <span class="token keyword">WHERE</span> name <span class="token operator">REGEXP</span> <span class="token string">'a{1,3}'</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="6函数"><a class="markdownIt-Anchor" href="#6函数"></a> 6.函数</h2>
<h3 id="1-字符串函数"><a class="markdownIt-Anchor" href="#1-字符串函数"></a> 1. 字符串函数</h3>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 拼接,HelloWorld</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token string">'World'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 小写,hello</span>
<span class="token keyword">SELECT</span> LOWER<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 大写,HELLO</span>
<span class="token keyword">SELECT</span> UPPER<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 左填充,---01</span>
<span class="token keyword">SELECT</span> LPAD<span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 右填充,01---</span>
<span class="token keyword">SELECT</span> RPAD<span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 去除两边空格,Hello World</span>
<span class="token keyword">SELECT</span> TRIM<span class="token punctuation">(</span><span class="token string">' Hello World '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 切片（起始索引为1）,Hello</span>
<span class="token keyword">SELECT</span> SUBSTRING<span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 替换，结果是http:www.google.com.cn</span>
<span class="token keyword">SELECT</span> REPLACE<span class="token punctuation">(</span>'http:<span class="token comment" spellcheck="true">//www.google.com.cn/','/','');</span>
<span class="token comment" spellcheck="true">-- 类型转换 下面浮点数转字符串</span>
cast<span class="token punctuation">(</span><span class="token number">3.14</span> <span class="token keyword">as</span> char<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">,</span>char<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="2-数值函数"><a class="markdownIt-Anchor" href="#2-数值函数"></a> 2. 数值函数</h3>
<table>
<thead>
<tr>
<th style="text-align:left">函数</th>
<th style="text-align:left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">CEIL(x)</td>
<td style="text-align:left">向上取整</td>
</tr>
<tr>
<td style="text-align:left">FLOOR(x)</td>
<td style="text-align:left">向下取整</td>
</tr>
<tr>
<td style="text-align:left">MOD(x, y)</td>
<td style="text-align:left">返回x/y的模</td>
</tr>
<tr>
<td style="text-align:left">RAND()</td>
<td style="text-align:left">返回0~1内的随机数</td>
</tr>
<tr>
<td style="text-align:left">ROUND(x, y)</td>
<td style="text-align:left">求参数x的四舍五入值，保留y位小数</td>
</tr>
</tbody>
</table>
<h3 id="3-日期函数"><a class="markdownIt-Anchor" href="#3-日期函数"></a> 3. 日期函数</h3>
<table>
<thead>
<tr>
<th style="text-align:left">函数</th>
<th style="text-align:left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">CURDATE()</td>
<td style="text-align:left">返回当前日期</td>
</tr>
<tr>
<td style="text-align:left">CURTIME()</td>
<td style="text-align:left">返回当前时间</td>
</tr>
<tr>
<td style="text-align:left">NOW()</td>
<td style="text-align:left">返回当前日期和时间</td>
</tr>
<tr>
<td style="text-align:left">YEAR(date)</td>
<td style="text-align:left">获取指定date的年份</td>
</tr>
<tr>
<td style="text-align:left">MONTH(date)</td>
<td style="text-align:left">获取指定date的月份</td>
</tr>
<tr>
<td style="text-align:left">DAY(date)</td>
<td style="text-align:left">获取指定date的日期</td>
</tr>
<tr>
<td style="text-align:left">DATE_ADD(date, INTERVAL expr type)</td>
<td style="text-align:left">返回一个日期/时间值加上一个时间间隔expr后的时间值</td>
</tr>
<tr>
<td style="text-align:left">DATEDIFF(date1, date2)</td>
<td style="text-align:left">返回起始时间date1和结束时间date2之间的天数</td>
</tr>
</tbody>
</table>
<h3 id="4-系统信息函数"><a class="markdownIt-Anchor" href="#4-系统信息函数"></a> 4. 系统信息函数</h3>
<table>
<thead>
<tr>
<th></th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>charset(str)</td>
<td>返回str字符集</td>
</tr>
<tr>
<td>current_user()<br>session_user()<br>user()<br>system_user()</td>
<td>返回当前用户名称</td>
</tr>
<tr>
<td>connection_id()</td>
<td>当前用户连接id</td>
</tr>
<tr>
<td>schema()</td>
<td>当前数据库名</td>
</tr>
<tr>
<td>version()</td>
<td>数据库版本号</td>
</tr>
</tbody>
</table>
<h3 id="5-流程函数"><a class="markdownIt-Anchor" href="#5-流程函数"></a> 5. 流程函数</h3>
<table>
<thead>
<tr>
<th>if(value, t, f)</th>
<th>如果value为true，则返回t，否则返回f</th>
</tr>
</thead>
<tbody>
<tr>
<td>ifnull(value1, value2)</td>
<td>如果value1不为空，返回value1，否则返回value2</td>
</tr>
<tr>
<td>if…then…elseif…then…else…end if;</td>
<td></td>
</tr>
<tr>
<td>case when…then…when…then…else…end</td>
<td></td>
</tr>
<tr>
<td>case…when…then…when…then…else…end</td>
<td>类似c语言switch</td>
</tr>
</tbody>
</table>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'Ok'</span><span class="token punctuation">,</span> <span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- OK</span>
<span class="token comment" spellcheck="true">-- ''空串不是null,返回''空串</span>
<span class="token keyword">select</span> ifnull<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'Default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 返回Default</span>
<span class="token keyword">select</span> ifnull<span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'Default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> name<span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> <span class="token string">'北京'</span> <span class="token keyword">then</span> <span class="token string">'一线城市'</span> <span class="token keyword">when</span> <span class="token string">'深圳'</span> <span class="token keyword">then</span> <span class="token string">'一线城市'</span> <span class="token keyword">else</span> <span class="token string">'二线城市'</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'城市级别'</span>
<span class="token keyword">from</span> tb_employ<span class="token punctuation">;</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token keyword">case</span> math <span class="token keyword">when</span> <span class="token number">100</span> <span class="token keyword">then</span> <span class="token string">'满分'</span> <span class="token keyword">when</span> <span class="token number">0</span> <span class="token keyword">then</span> <span class="token string">'鸭蛋'</span> <span class="token keyword">else</span> <span class="token string">'不完美的战士也是战士'</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'评价'</span>
<span class="token keyword">from</span> tb_score<span class="token punctuation">;</span>
</code></pre>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230918135400012-1696489133306-21.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230918135400012-1696489133306-21.png" class="lozad post-image"></p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">update</span> tb_Salary <span class="token keyword">set</span> sex<span class="token operator">=</span><span class="token keyword">if</span><span class="token punctuation">(</span>sex<span class="token operator">=</span><span class="token string">"f"</span><span class="token punctuation">,</span><span class="token string">"m"</span><span class="token punctuation">,</span><span class="token string">"f"</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> sno<span class="token punctuation">,</span><span class="token keyword">CASE</span> sex
    <span class="token keyword">WHEN</span> <span class="token string">'男'</span> <span class="token keyword">THEN</span> <span class="token string">'M'</span>
    <span class="token keyword">WHEN</span> <span class="token string">'女'</span> <span class="token keyword">THEN</span> <span class="token string">'F'</span>
    <span class="token keyword">END</span> <span class="token keyword">AS</span> sex <span class="token keyword">FROM</span> s<span class="token punctuation">;</span>
</code></pre>
<h2 id="7-约束"><a class="markdownIt-Anchor" href="#7-约束"></a> 7. 约束</h2>
<h3 id="1-常见约束"><a class="markdownIt-Anchor" href="#1-常见约束"></a> 1. 常见约束</h3>
<table>
<thead>
<tr>
<th style="text-align:left">约束</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">关键字</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">非空约束</td>
<td style="text-align:left">限制该字段的数据不能为null</td>
<td style="text-align:left">NOT NULL</td>
</tr>
<tr>
<td style="text-align:left">唯一约束</td>
<td style="text-align:left">保证该字段的所有数据都是唯一、不重复的</td>
<td style="text-align:left">UNIQUE</td>
</tr>
<tr>
<td style="text-align:left">主键约束</td>
<td style="text-align:left">主键是一行数据的唯一标识，<strong>要求非空且不重复,每张表最多一个</strong></td>
<td style="text-align:left">PRIMARY KEY</td>
</tr>
<tr>
<td style="text-align:left">默认约束</td>
<td style="text-align:left">保存数据时，如果未指定该字段的值，则采用默认值</td>
<td style="text-align:left">DEFAULT</td>
</tr>
<tr>
<td style="text-align:left">检查约束（8.0.1版本后）</td>
<td style="text-align:left">保证字段值满足某一个条件</td>
<td style="text-align:left">CHECK</td>
</tr>
<tr>
<td style="text-align:left">外键约束</td>
<td style="text-align:left">用来让两张图的数据之间建立连接，保证数据的一致性和完整性</td>
<td style="text-align:left">FOREIGN KEY</td>
</tr>
<tr>
<td style="text-align:left">自增</td>
<td style="text-align:left">详见下面</td>
<td style="text-align:left">AUTO_INCREMENT</td>
</tr>
</tbody>
</table>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true"># 列级约束</span>
字段名 数据类型 <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span>
<span class="token comment" spellcheck="true">#表级约束</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span>（字段名<span class="token number">1</span><span class="token punctuation">,</span>字段名<span class="token number">2</span><span class="token punctuation">,</span>…）
</code></pre>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb4<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
    age <span class="token keyword">int</span> <span class="token keyword">check</span><span class="token punctuation">(</span>age <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">and</span> age <span class="token operator">&lt;</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">status</span> char<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
    gender char<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="2-外键约束foreign-key"><a class="markdownIt-Anchor" href="#2-外键约束foreign-key"></a> 2. 外键约束foreign key</h3>
<p><strong>候选键</strong>（Candidate Key）：一个属性或属性组的值能唯一标识一个元组，而子集不能。</p>
<p>比如，想要知道某位学生的某门课程的成绩Grade，那我们必须要知道该学生的学号Sno以及课程号Cno。此时X[Sno,Cno]称为S的一个候选码。</p>
<p><strong>主键</strong>：当有多个候选键时，可以选定一个作为主键，选定的候选键称为主键（主码）。</p>
<p><strong>外键</strong>：一个表（从表，参照表）的字段引用主表（被参照表）的主键或者唯一键。</p>
<p><strong>前提：</strong></p>
<p>1、创建外键的表和列存在</p>
<p>2、组成外键的列存在索引</p>
<p>3、必须指定数据表的引擎为InnoDB</p>
<p>4、外键字段和关联字段，数据类型和长度必须一致</p>
<p>5、引用字段的值必须存在于被引用表中。</p>
<p>6、定义外键约束名称(如FK_ID)时，不能加单引号和双引号，可以反引号。</p>
<table>
<thead>
<tr>
<th style="text-align:left">行为</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">no action</td>
<td style="text-align:left">当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新（与RESTRICT一致）</td>
</tr>
<tr>
<td style="text-align:left">restrict</td>
<td style="text-align:left">与no action一致</td>
</tr>
<tr>
<td style="text-align:left">cascade</td>
<td style="text-align:left">当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则也删除/更新外键在子表中的记录</td>
</tr>
<tr>
<td style="text-align:left">set null</td>
<td style="text-align:left">当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则设置子表中该外键值为null（要求该外键允许为null）</td>
</tr>
<tr>
<td style="text-align:left">set default</td>
<td style="text-align:left">父表有变更时，子表将外键设为一个默认值（Innodb不支持）</td>
</tr>
</tbody>
</table>
<h4 id="1-创建外键"><a class="markdownIt-Anchor" href="#1-创建外键"></a> 1. 创建外键</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> father<span class="token punctuation">(</span>
	cid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
    classname char<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> child<span class="token punctuation">(</span>
	id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name char<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
    classid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> 外键约束名 <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>classid<span class="token punctuation">)</span> <span class="token keyword">references</span> father<span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">restrict</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span>  
<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 外键约束名不加引号</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> father <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'一班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> father <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'二班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> father <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'三班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 报错，因为父表没有为5的cid</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> child <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 子表插入记录成功</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> child <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">//使用alter table创建外键</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> mydb<span class="token punctuation">.</span>employees
<span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> FK_ID <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> department <span class="token punctuation">(</span>id<span class="token punctuation">)</span> 
<span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">RESTRICT</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="2-查看外键"><a class="markdownIt-Anchor" href="#2-查看外键"></a> 2. 查看外键</h4>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">desc</span> <span class="token number">db1</span><span class="token punctuation">.</span>child classid<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+-------------+------+-----+---------+-------+</span>
<span class="token operator">|</span> Field   <span class="token operator">|</span> <span class="token keyword">Type</span>        <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+-------------+------+-----+---------+-------+</span>
<span class="token operator">|</span> classid <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span> MUL <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+-------------+------+-----+---------+-------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.11</span> sec<span class="token punctuation">)</span>
</code></pre>
<p>添加了外键约束的classid 字段的 Key(索引) 值为MUL，表示非唯一性索引(MUL TIPLE KEY)，值可以重复。</p>
<h4 id="3-修改和删除外键"><a class="markdownIt-Anchor" href="#3-修改和删除外键"></a> 3. 修改和删除外键</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 修改外键</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> child <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> 外键约束名<span class="token punctuation">,</span><span class="token keyword">add</span> <span class="token keyword">constraint</span> 外键名 <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>classid<span class="token punctuation">)</span> <span class="token keyword">references</span> father<span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 删除外键</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> child <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> 外键名<span class="token punctuation">;</span>
</code></pre>
<h4 id="4-启用或禁用外键"><a class="markdownIt-Anchor" href="#4-启用或禁用外键"></a> 4. 启用或禁用外键</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 禁用约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">DISABLE</span> <span class="token keyword">CONSTRAINT</span> 约束名<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 启用约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">ENABLE</span> <span class="token keyword">CONSTRAINT</span> 约束名<span class="token punctuation">;</span>
</code></pre>
<h3 id="3-自动增长"><a class="markdownIt-Anchor" href="#3-自动增长"></a> 3. 自动增长</h3>
<ul>
<li>
<p>一个表中<strong>只能有一个</strong>自动增长字段，该字段的数据类型是<strong>整数类型</strong>，且必须定义为键，如 <code>UNIQUE KEY</code> 、<code>PRIMARY KEY</code></p>
</li>
<li>
<p>若为自动增长字段插入 <code>NULL</code>、<code>0</code>、<code>DEFAULT</code> 或在插入时省略该字段，则该字段就会使用自动增长值；若插入的是一个具体值，则不会使用自动增长值。</p>
</li>
<li>
<p>自动增长值从 1 开始自增，每次加 1。若插入的值大于自动增长的值，则下次插入的自动增长值会自动使用最大值加 1；若插入的值小于自动增长值，则不会对自动增长值产生影响。</p>
</li>
<li>
<p>使用 DELETE 删除记录时，自动增长值不会减小或填补空缺。</p>
</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 自增初值为100，每次自增1</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> test1 <span class="token keyword">auto_increment</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 添加自动增长</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">MODIFY</span> 字段名 字段类型 <span class="token punctuation">[</span>字段属性<span class="token punctuation">]</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 删除自动增长</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 数据库名 <span class="token keyword">MODIFY</span> 字段名 字段类型 <span class="token punctuation">[</span>字段属性<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="8-多表查询"><a class="markdownIt-Anchor" href="#8-多表查询"></a> 8. 多表查询</h2>
<h3 id="1-多表关系"><a class="markdownIt-Anchor" href="#1-多表关系"></a> 1. 多表关系</h3>
<blockquote>
<p>一对多</p>
</blockquote>
<p>比如一个部门对应多个员工，一个员工对应一个部门<br>
实现：在多的一方建立外键，指向一的一方的主键</p>
<blockquote>
<p>多对多</p>
</blockquote>
<p>比如一个学生可以选多门课程，一门课程也可以供多个学生选修<br>
实现：建立第三张中间表，中间表至少包含两个外键，分别关联两方主键</p>
<blockquote>
<p>一对一</p>
</blockquote>
<p>关系：一对一关系，多用于单表拆分，将一张表的基础字段放在一张表中，其他详情字段放在另一张表中，以提升操作效率<br>
实现：在任意一方加入外键，关联另外一方的主键，并且设置外键为unique。</p>
<h3 id="2-合并查询"><a class="markdownIt-Anchor" href="#2-合并查询"></a> 2. 合并查询</h3>
<blockquote>
<p>合并查询（笛卡尔积，会展示所有组合结果）：</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> child<span class="token punctuation">,</span>teacher<span class="token punctuation">,</span>father<span class="token punctuation">;</span>
</code></pre>
<p>笛卡尔积：两个集合A集合和B集合的所有组合情况（在多表查询时，需要消除无效的笛卡尔积）</p>
<blockquote>
<p>消除无效笛卡尔乘积</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> child<span class="token punctuation">,</span>teacher<span class="token punctuation">,</span>father <span class="token keyword">where</span> teacher<span class="token punctuation">.</span>id<span class="token operator">=</span>child<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre>
<h3 id="3-内连接查询"><a class="markdownIt-Anchor" href="#3-内连接查询"></a> 3. 内连接查询</h3>
<p>内连接查询的是两张表交集的部分</p>
<p>隐式内连接：<br>
<code>SELECT 字段列表 FROM 表1, 表2 WHERE 条件 ...;</code></p>
<p>显式内连接：<br>
<code>SELECT 字段列表 FROM 表1 [ INNER ] JOIN 表2 ON 连接条件 ...;</code></p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token number">e</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token number">d</span><span class="token punctuation">.</span>name <span class="token keyword">from</span> employee <span class="token keyword">as</span> <span class="token number">e</span><span class="token punctuation">,</span> dept <span class="token keyword">as</span> <span class="token number">d</span> <span class="token keyword">where</span> <span class="token number">e</span><span class="token punctuation">.</span>dept <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test2 <span class="token keyword">inner</span> <span class="token keyword">join</span> teacher <span class="token keyword">on</span> test2<span class="token punctuation">.</span>id<span class="token operator">=</span>teacher<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre>
<h3 id="4-外连接查询"><a class="markdownIt-Anchor" href="#4-外连接查询"></a> 4. 外连接查询</h3>
<p><strong>左外连接</strong>：<br>
查询左表所有数据，以及两张表交集部分数据<br>
<code>SELECT 字段列表 FROM 表1 LEFT [ OUTER ] JOIN 表2 ON 条件 ...;</code><br>
相当于查询表1的所有数据，包含表1和表2交集部分数据,outer可以省略</p>
<p><strong>右外连接</strong>：<br>
查询右表所有数据，以及两张表交集部分数据<br>
<code>SELECT 字段列表 FROM 表1 RIGHT [ OUTER ] JOIN 表2 ON 条件 ...;</code></p>
<p>相当于查询表2的所有数据，包含表1和表2交集部分数据</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 左</span>
<span class="token keyword">select</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token number">d</span><span class="token punctuation">.</span>name <span class="token keyword">from</span> employee <span class="token keyword">as</span> <span class="token number">e</span> <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept <span class="token keyword">as</span> <span class="token number">d</span> <span class="token keyword">on</span> <span class="token number">e</span><span class="token punctuation">.</span>dept <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- e是别名</span>
<span class="token keyword">select</span> <span class="token number">d</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> dept <span class="token number">d</span> <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> emp <span class="token number">e</span> <span class="token keyword">on</span> <span class="token number">e</span><span class="token punctuation">.</span>dept <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">-- 这条语句与下面的语句效果一样</span>
<span class="token comment" spellcheck="true">-- 右</span>
<span class="token keyword">select</span> <span class="token number">d</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">as</span> <span class="token number">e</span> <span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept <span class="token keyword">as</span> <span class="token number">d</span> <span class="token keyword">on</span> <span class="token number">e</span><span class="token punctuation">.</span>dept <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre>
<h3 id="5-自连接查询"><a class="markdownIt-Anchor" href="#5-自连接查询"></a> 5. 自连接查询</h3>
<p>当前表与自身的连接查询，自连接必须使用表别名。</p>
<p>语法：<br>
<code>SELECT 字段列表 FROM 表A 别名A JOIN 表A 别名B ON 条件 ...;</code></p>
<p>自连接查询，可以是内连接查询，也可以是外连接查询。</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 查询员工及其所属领导的名字,输出时a.name替换成员工名字</span>
<span class="token keyword">select</span> <span class="token number">a</span><span class="token punctuation">.</span>name <span class="token keyword">as</span> 员工名字<span class="token punctuation">,</span> <span class="token number">b</span><span class="token punctuation">.</span>name <span class="token keyword">as</span> 所属领导名字 <span class="token keyword">from</span> employee <span class="token number">a</span><span class="token punctuation">,</span> employee <span class="token number">b</span> <span class="token keyword">where</span> <span class="token number">a</span><span class="token punctuation">.</span>managerid <span class="token operator">=</span> <span class="token number">b</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 没有领导的也查询出来</span>
<span class="token keyword">select</span> <span class="token number">a</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token number">b</span><span class="token punctuation">.</span>name <span class="token keyword">from</span> employee <span class="token number">a</span> <span class="token keyword">left</span> <span class="token keyword">join</span> employee <span class="token number">b</span> <span class="token keyword">on</span> <span class="token number">a</span><span class="token punctuation">.</span>managerid <span class="token operator">=</span> <span class="token number">b</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre>
<p>在连接查询时，若<code>数据表连接的字段同名</code>，则连接时的<code>匹配条件</code>可以使用 <code>USING</code> 代替ON，多个同名的连接字段之间用逗号分隔。</p>
<h3 id="6-联合查询unionunion-all"><a class="markdownIt-Anchor" href="#6-联合查询unionunion-all"></a> 6. 联合查询union，union all</h3>
<p>把多次查询的结果合并，形成一个新的查询集。</p>
<p>union会对结果进行并集操作，<strong>去除重复行</strong>。</p>
<p>union all 将查询结果合并，<strong>保留重复行</strong>。</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 不去重，升序排序</span>
<span class="token keyword">select</span> money <span class="token keyword">from</span> test2 <span class="token keyword">union</span> <span class="token keyword">all</span> <span class="token keyword">select</span> money <span class="token keyword">from</span> test3 <span class="token keyword">order</span> <span class="token keyword">by</span> money <span class="token keyword">ASC</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 去重</span>
<span class="token keyword">select</span> money <span class="token keyword">from</span> test2 <span class="token keyword">union</span>  <span class="token keyword">select</span> money <span class="token keyword">from</span> test3 <span class="token keyword">order</span> <span class="token keyword">by</span> money <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>联合查询比使用or效率高，不会使索引失效</li>
</ul>
<h3 id="7-子查询嵌套查询"><a class="markdownIt-Anchor" href="#7-子查询嵌套查询"></a> 7. 子查询(嵌套查询)</h3>
<p>SQL语句中嵌套SELECT语句，称谓嵌套查询，又称子查询。<br>
<code>SELECT * FROM t1 WHERE column1 = ( SELECT column1 FROM t2);</code><br>
<strong>子查询外部的语句可以是 INSERT / UPDATE / DELETE / SELECT 的任何一个</strong></p>
<p>根据子查询结果可以分为：</p>
<ul>
<li>标量子查询（子查询结果为单个值）</li>
<li>列子查询（子查询结果为一列）</li>
<li>行子查询（子查询结果为一行）</li>
<li>表子查询（子查询结果为多行多列）</li>
</ul>
<p>根据子查询位置可分为：</p>
<ul>
<li>WHERE 之后</li>
<li>FROM 之后</li>
<li>SELECT 之后</li>
</ul>
<h4 id="1-标量子查询"><a class="markdownIt-Anchor" href="#1-标量子查询"></a> 1. 标量子查询</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 查询在张三入职时间后公司新来同事</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> entrydate <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> entrydate <span class="token keyword">from</span> employee <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="2-列子查询"><a class="markdownIt-Anchor" href="#2-列子查询"></a> 2. 列子查询</h4>
<p>常用操作符：</p>
<table>
<thead>
<tr>
<th style="text-align:left">操作符</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">IN</td>
<td style="text-align:left">在指定的集合范围内，多选一</td>
</tr>
<tr>
<td style="text-align:left">NOT IN</td>
<td style="text-align:left">不在指定的集合范围内</td>
</tr>
<tr>
<td style="text-align:left">ANY</td>
<td style="text-align:left">子查询返回列表中，有任意一个满足即可</td>
</tr>
<tr>
<td style="text-align:left">SOME</td>
<td style="text-align:left">与ANY等同，使用SOME的地方都可以使用ANY</td>
</tr>
<tr>
<td style="text-align:left">ALL</td>
<td style="text-align:left">子查询返回列表的所有值都必须满足</td>
</tr>
</tbody>
</table>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> money <span class="token keyword">from</span> test3 <span class="token keyword">where</span> money <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> money <span class="token keyword">from</span> test2 <span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">select</span> money <span class="token keyword">from</span> test3 <span class="token keyword">where</span> money<span class="token operator">></span><span class="token keyword">any</span><span class="token punctuation">(</span><span class="token keyword">select</span> money <span class="token keyword">from</span> test2 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- 大于其中之一</span>
<span class="token keyword">select</span> money <span class="token keyword">from</span> test3 <span class="token keyword">where</span> money<span class="token operator">></span><span class="token keyword">all</span><span class="token punctuation">(</span><span class="token keyword">select</span> money <span class="token keyword">from</span> test2 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- 大于全部</span>
</code></pre>
<h4 id="3-行子查询"><a class="markdownIt-Anchor" href="#3-行子查询"></a> 3. 行子查询</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test3 <span class="token keyword">where</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span>money<span class="token punctuation">)</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id<span class="token punctuation">,</span>money <span class="token keyword">from</span> test2 <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="4-表子查询"><a class="markdownIt-Anchor" href="#4-表子查询"></a> 4. 表子查询</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test3 <span class="token keyword">where</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span>money<span class="token punctuation">)</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id<span class="token punctuation">,</span>money <span class="token keyword">from</span> test2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="9-视图与索引"><a class="markdownIt-Anchor" href="#9-视图与索引"></a> 9. 视图与索引</h2>
<h3 id="1-视图"><a class="markdownIt-Anchor" href="#1-视图"></a> 1. 视图</h3>
<p>视图是在一个、多个基本表或视图基础上，通过查询语句定义的虚拟表格。</p>
<ul>
<li>
<p>视图可用于SELECT语句中进行查询</p>
</li>
<li>
<p>视图<strong>只存储定义语句</strong>，不存储其数据</p>
</li>
<li>
<p>当使用视图进行查询时，视图包含的数据才会临时生成。</p>
</li>
</ul>
<p>视图作用：提升数据操作的便携性，提升了数据的安全性，提升了数据的逻辑独立性，视图可用于数据集成。</p>
<p>视图的工作机制：视图中的内容总是与基本表中数据保持一致，即当基本表中数据发生变化时，相关视图的数据也随之变化。</p>
<h4 id="1-视图创建"><a class="markdownIt-Anchor" href="#1-视图创建"></a> 1. 视图创建</h4>
<p>CREATE [OR REPLACE ] [ALGORITHM={ UNDEFINED | MERGE | TEMPTABLE}]</p>
<p>[DEFINER = { user | CURRENT_USER }]</p>
<p>VIEW 视图名[(视图字段列表)]</p>
<p>AS 查询语句</p>
<p>[WITH [CASCADED | LOCAL] CHECK OPTION];</p>
<ul>
<li>
<p>添加OR REPLACE可选参数表明可以在创建视图时替换数据库已有8同名视图。</p>
</li>
<li>
<p>ALGORITHM表示视图的使用方法。其中，UNDEFINE表示由MySQL自行决定使用方法。</p>
</li>
<li>
<p>WITH CHECK OPTION表示更新、修改和插入视图数据时，只有满足检查条件操作才会执行。</p>
</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 创建视图</span>
<span class="token keyword">create</span> <span class="token operator">or</span> replace <span class="token keyword">view</span> s_view <span class="token keyword">as</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> s <span class="token keyword">where</span> dept<span class="token operator">=</span><span class="token string">'信息学院'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 多张基本表上创建视图</span>
<span class="token keyword">create</span> <span class="token operator">or</span> replace <span class="token keyword">view</span> ts_view<span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">select</span> tb_score<span class="token punctuation">.</span>name<span class="token punctuation">,</span>age <span class="token keyword">from</span> teacher<span class="token punctuation">,</span>tb_score <span class="token keyword">where</span> teacher<span class="token punctuation">.</span>id<span class="token operator">=</span>tb_score<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 在视图上创建视图</span>
<span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> s_maj_view <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> s_view <span class="token keyword">WHERE</span> maj<span class="token operator">=</span><span class="token string">'计算机'</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>不能在SELECT语句中包含系统、用户变量以及处理语句参数，同时不能在FROM子句中包含子查询</strong></p>
<p><strong>删除视图依赖的基本表后，视图使用会报错，可通过“CHECK TABLE 表名”检查基本表状态。</strong></p>
<p><strong>不能为临时表创建视图。</strong></p>
<p><strong>创建视图时，ALGORITHM参数指定对部分查询结果具有影响。</strong></p>
<h4 id="2-视图管理"><a class="markdownIt-Anchor" href="#2-视图管理"></a> 2. 视图管理</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 查看视图</span>
<span class="token keyword">describe</span> ts_view<span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 查看定义(字段之类)</span>
<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">view</span> ts_view<span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 查看结构</span>
<span class="token comment" spellcheck="true">-- 删除视图</span>
<span class="token keyword">drop</span> <span class="token keyword">view</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> ts_view<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 更新视图的数据(其实更新的是对应的基本表数据)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> s_update_view <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'s10'</span><span class="token punctuation">,</span><span class="token string">'韩义'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token string">'计算机'</span><span class="token punctuation">,</span><span class="token string">'信息学院'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">UPDATE</span> s_update_view <span class="token keyword">SET</span> age <span class="token operator">=</span> <span class="token number">20</span>　<span class="token keyword">WHERE</span> sno <span class="token operator">=</span> <span class="token string">'s10'</span><span class="token punctuation">;</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> s_update_view <span class="token keyword">WHERE</span> sno <span class="token operator">=</span> <span class="token string">'s10'</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="2-索引"><a class="markdownIt-Anchor" href="#2-索引"></a> 2. 索引</h3>
<p>优点：</p>
<p>–提高查询执行的速度。</p>
<p>–强制实施数据的唯一性。</p>
<p>–提高表之间联接的速度。</p>
<p>缺点</p>
<p>–存储索引要占用磁盘空间。</p>
<p>–数据修改需要更长的时间，因为索引也要更新。</p>
<p>–创建索引要花时间。</p>
<p><strong>按索引特征</strong>：普通索引、唯一索引(unique)、主键索引、全文索引(fulltext)和空间索引(spatial)。</p>
<p><strong>根据索引存储方式进行分类</strong>：B-Tree索引、Hash索引</p>
<p><strong>根据索引与数据物理存储关系</strong>：聚集型索引、非聚集型索引</p>
<p><strong>根据索引涉及列数进行</strong>：单列索引、复合索引</p>
<p>复合索引需要遵循最左匹配原则。</p>
<h4 id="1-索引创建"><a class="markdownIt-Anchor" href="#1-索引创建"></a> 1. 索引创建</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">UNIQUE</span> <span class="token operator">|</span> FULLTEXT <span class="token operator">|</span> SPATIAL<span class="token punctuation">]</span> <span class="token keyword">INDEX</span> 索引名称
<span class="token keyword">ON</span> 表名称<span class="token punctuation">(</span>字段名称<span class="token punctuation">[</span><span class="token punctuation">(</span>索引字符长度<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token keyword">ASC</span> <span class="token operator">|</span> <span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>当字段名称[(索引字符长度) [ASC | DESC]]只有一项时，将建立单列索引。当字段名称[(索引字符长度) [ASC | DESC]]有多项时，将建立复合索引。</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> t_name_index <span class="token keyword">on</span> teacher<span class="token punctuation">(</span>name<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 为teacher创建普通索引，针对name的前三个字符降序排列</span>
<span class="token keyword">create</span> <span class="token keyword">unique</span> <span class="token keyword">index</span> c_cn_ct_index <span class="token keyword">on</span> <span class="token number">c</span><span class="token punctuation">(</span>cn<span class="token punctuation">,</span>ct<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 为课程表c的课程名（cn）和学时（ct）字段建立复合唯一索引</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> classroom<span class="token punctuation">(</span>
    cid <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	crno <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">-- 教室编号</span>
	cbn <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">-- 教学楼编号</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">unique</span> <span class="token keyword">index</span> nb_index<span class="token punctuation">(</span>crno<span class="token punctuation">,</span> cbn<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 建表时创建索引</span>

<span class="token comment" spellcheck="true">-- 为已有表创建索引</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> teacher <span class="token keyword">add</span> <span class="token keyword">index</span> t_name_index<span class="token punctuation">(</span>name<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="2-索引管理"><a class="markdownIt-Anchor" href="#2-索引管理"></a> 2. 索引管理</h4>
<blockquote>
<p>查看索引</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>使用索引</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> teacher <span class="token keyword">add</span> fulltext <span class="token keyword">index</span> t_name_index<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teacher <span class="token keyword">where</span> <span class="token keyword">MATCH</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> against<span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 全文索引使用</span>
<span class="token comment" spellcheck="true">-- 普通索引跟平常用select没区别</span>
</code></pre>
<blockquote>
<p>删除索引</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> teacher <span class="token keyword">drop</span> <span class="token keyword">index</span> t_name_index<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">index</span> t_name_index <span class="token keyword">on</span> teacher<span class="token punctuation">;</span>
</code></pre>
<h2 id="10-数据库安全管理"><a class="markdownIt-Anchor" href="#10-数据库安全管理"></a> 10. 数据库安全管理</h2>
<p>安全控制的一般方法：用户登录，安全审计，权限管理，文件权限，数据加密。</p>
<h3 id="1-添加用户"><a class="markdownIt-Anchor" href="#1-添加用户"></a> 1. 添加用户</h3>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928165255873-1696489152413-23.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928165255873-1696489152413-23.png" class="lozad post-image"></p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> <span class="token string">'student'</span>@'localhost<span class="token string">' identified by '</span>student123'<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#用户为student，密码student123，只允许在mysql所在服务器上登陆</span>
</code></pre>
<h3 id="2-用户管理"><a class="markdownIt-Anchor" href="#2-用户管理"></a> 2. 用户管理</h3>
<blockquote>
<p>重命名</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">rename</span> <span class="token keyword">user</span> <span class="token string">'student'</span>@'localhost<span class="token string">' to stu@'</span><span class="token operator">%</span>'<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 更名为stu,%表示任意位置</span>
</code></pre>
<blockquote>
<p>修改密码</p>
</blockquote>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928170318534-1696489159820-25.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928170318534-1696489159820-25.png" class="lozad post-image"></p>
<pre class=" language-sql"><code class="language-sql">mysqladmin <span class="token operator">-</span>u stu <span class="token operator">-</span>p password<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>修改用户</p>
</blockquote>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928170523997-1696489164660-27.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928170523997-1696489164660-27.png" class="lozad post-image"></p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">user</span> stu@'<span class="token operator">%</span><span class="token string">' identified by '</span>student123'<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>删除用户</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">drop</span> <span class="token keyword">user</span> stu@'<span class="token operator">%</span><span class="token string">';
delete from mysql.user where user='</span>stu<span class="token string">' and host='</span><span class="token operator">%</span>'<span class="token punctuation">;</span>
</code></pre>
<h3 id="3-权限管理"><a class="markdownIt-Anchor" href="#3-权限管理"></a> 3. 权限管理</h3>
<blockquote>
<p>权限授予</p>
</blockquote>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928170904865-1696489169867-29.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928170904865-1696489169867-29.png" class="lozad post-image"></p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'teacher1'</span><span class="token variable">@'localhost'</span> <span class="token keyword">with</span> <span class="token keyword">grant</span> <span class="token keyword">option</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#为teacher10用户赋予数据库服务器的所有使用权限（ALL），并允许权限由teacher10授予其他用户。</span>

<span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span><span class="token punctuation">,</span> <span class="token keyword">UPDATE</span> 
<span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'teacher6'</span><span class="token variable">@'localhost'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#为teacher6用户赋予数据库服务器级别的查找、插入和更新数据权限（SELECT、INSERT、UPDATE），并且不允许二次授权。</span>

<span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">(</span>tno<span class="token punctuation">,</span> tn<span class="token punctuation">)</span>
<span class="token keyword">ON</span> teaching<span class="token punctuation">.</span>t <span class="token keyword">TO</span> <span class="token string">'teacher2'</span><span class="token variable">@'192.168.1.23'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#为teacher2用户赋予teaching数据库中教师表t上tno字段和tn字段的查找数据权限SELECT，并不允许权限由teacher2授予其他用户。</span>
</code></pre>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928171720098.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230928171720098.png" class="lozad post-image"></p>
<blockquote>
<p>权限查看</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">show</span> grants <span class="token keyword">for</span> <span class="token string">'student'</span><span class="token variable">@'localhost'</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> GRANTS <span class="token keyword">FOR</span> <span class="token keyword">CURRENT_USER</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>权限回收</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">revoke</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">delete</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'student'</span><span class="token variable">@'localhost'</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>权限转移</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'teacher1'</span><span class="token variable">@'localhost'</span> <span class="token keyword">with</span> <span class="token keyword">grant</span> <span class="token keyword">option</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#允许teacher1将权限转移给其它用户</span>
</code></pre>
<h3 id="4-角色管理"><a class="markdownIt-Anchor" href="#4-角色管理"></a> 4. 角色管理</h3>
<p>角色（Role）是对权限集中管理的一种机制，通常根据特定需要，将一系列权限集中在一起构成角色。</p>
<p>一个用户可以分配多个角色，也允许一个角色分配给多个用户</p>
<blockquote>
<p>角色创建</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#创建可在任意主机上使用的教师角色和管理员角色。</span>
<span class="token keyword">create</span> role <span class="token string">'teacher'</span><span class="token punctuation">,</span><span class="token string">'administrator'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#创建可在本地主机上使用的开发者角色。</span>
<span class="token keyword">CREATE</span> ROLE <span class="token string">'developer'</span><span class="token variable">@'localhost'</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>角色授权</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> administrator<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#为管理员角色administrator授予服务器级别全局权限。</span>
<span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span><span class="token punctuation">,</span> <span class="token keyword">UPDATE</span><span class="token punctuation">,</span> <span class="token keyword">DELETE</span> <span class="token keyword">ON</span> teaching<span class="token punctuation">.</span>sc
<span class="token keyword">TO</span> <span class="token string">'teacher'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#为教师角色teacher授予teaching.sc表级别的查找SELECT、插入数据INSERT、更新数据UPDATE和删除数据DELETE权限。</span>
</code></pre>
<blockquote>
<p>角色激活</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#为用户teacher2分配角色</span>
<span class="token keyword">grant</span> <span class="token string">'teacher'</span> <span class="token keyword">to</span> <span class="token string">'teacher2'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#角色激活</span>
<span class="token keyword">set</span> <span class="token keyword">default</span> role <span class="token string">'teacher'</span> <span class="token keyword">to</span> <span class="token string">'teacher2'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 使用户teacher2上的teacher角色生效。</span>
<span class="token keyword">SET</span> <span class="token keyword">DEFAULT</span> ROLE <span class="token keyword">ALL</span> <span class="token keyword">TO</span> <span class="token string">'teacher3'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 使用户teacher3上的所有角色生效。</span>
</code></pre>
<blockquote>
<p>角色查看</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> current_role<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 查询当前用户生效的角色。</span>
</code></pre>
<blockquote>
<p>角色注销</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">revoke</span> <span class="token string">'teacher'</span> <span class="token keyword">from</span> <span class="token string">'teacher2'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 回收用户teacher2的角色teacher。</span>
<span class="token keyword">drop</span> role <span class="token string">'teacher'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 删除角色teacher。</span>
</code></pre>
<h2 id="11-数据库并发控制与封锁"><a class="markdownIt-Anchor" href="#11-数据库并发控制与封锁"></a> 11. 数据库并发控制与封锁</h2>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930222514629.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930222514629.png" class="lozad post-image"></p>
<h3 id="1-数据库并发性的含义"><a class="markdownIt-Anchor" href="#1-数据库并发性的含义"></a> 1. 数据库并发性的含义</h3>
<p>数据库最大的特点是<strong>数据共享</strong>，允许<strong>同一时间</strong>供<strong>多个用户</strong>根据自己的需要来操作数据库。</p>
<p><strong>串行</strong>：一个用户在运行程序时，其他用户程序必须等到这个用户程序结束才能对数据库进行存取。</p>
<p><strong>并行</strong>：最大限度地利用数据库，多个用户并行执行数据库。</p>
<p>数据库的<strong>并发性及并发控制机制</strong>是衡量数据库系统性能的重要标准。</p>
<p>在 MySQL 中，<strong>会话</strong>（session）是指客户端与服务器之间的交互过程，包括连接、执行 SQL 语句、获取结果等。</p>
<h3 id="2-事务及其性质"><a class="markdownIt-Anchor" href="#2-事务及其性质"></a> 2. 事务及其性质</h3>
<p>事务是一组操作的集合，事务会把所有操作作为一个<strong>整体</strong>一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。</p>
<p>用户看到的数据总能<strong>保持一致性</strong>。</p>
<h4 id="1-mysql支持4种事务模式"><a class="markdownIt-Anchor" href="#1-mysql支持4种事务模式"></a> 1. Mysql支持4种事务模式</h4>
<ul>
<li>
<p>自动提交模式：每执行一条SQL就提交</p>
</li>
<li>
<p>显式模式：有明确的事务开始和结束语句</p>
</li>
<li>
<p>隐式模式：没有事务开始语句，但有结束语句</p>
</li>
<li>
<p>分布式模式：适合多服务器系统</p>
</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 开启事务</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- 提交所执行的所有操作，标志事务的结束</span>
<span class="token keyword">rollback</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/*回滚语句，当事务运行过程中发生故障时，事务不能继续执行，此时回滚操作撤销了事务所做的修改，并结束当前这个事务*/</span>
</code></pre>
<h4 id="2-事务的性质四大特性acid"><a class="markdownIt-Anchor" href="#2-事务的性质四大特性acid"></a> 2. 事务的性质（四大特性ACID）</h4>
<ul>
<li>原子性(atomicity)：事务是不可分割的最小操作单元，操作要么都执行，要么都不执行</li>
<li>一致性：数据库始终保持一致性。事务完成时，必须使所有数据都保持一致状态。</li>
<li>隔离性：并发执行的事务之间不会相互影响。</li>
<li>持久性(durability)：一个事务被提交后，对数据库中数据的改变是永久性的。</li>
</ul>
<p><strong>注意</strong>：commit没执行，虽然真表的内容没变，但是假表的内容变了，需要回滚假表。(select可以查到假表,navicat双击数据表看到真表)</p>
<h4 id="3-用户定义的模式"><a class="markdownIt-Anchor" href="#3-用户定义的模式"></a> 3. 用户定义的模式</h4>
<p>隐式模式：</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 查看事务提交方式</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@AUTOCOMMIT</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">-- 设置事务提交方式，1为自动提交，0为手动提交，该设置只对当前会话有效</span>
<span class="token keyword">SET</span> @<span class="token variable">@AUTOCOMMIT</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- 改为0，则需要在操作完后commit才会修改数据表</span>

<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
因为这一行发生错误，所以下面<span class="token keyword">commit</span>不会执行<span class="token punctuation">,</span>假表内容被改变了，需要<span class="token keyword">rollback</span>事务
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span> 
<span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre>
<p>显式模式：</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 开启事务,也可begin transaction</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money<span class="token operator">=</span>money<span class="token number">-1000</span> <span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money<span class="token operator">=</span>money<span class="token operator">+</span><span class="token number">1000</span> <span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">'李四'</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 全部执行成功后，提交事务</span>
</code></pre>
<h3 id="3-并发控制与数据的不一致性"><a class="markdownIt-Anchor" href="#3-并发控制与数据的不一致性"></a> 3. 并发控制与数据的不一致性</h3>
<p>​	能够合理调度并发事务，避免并发事务之间的互相干扰造成数据不一致性的技术称为数据库管理系统的并发控制技术。</p>
<p>数据不一致性的种类：</p>
<blockquote>
<p>1.丢失更新</p>
</blockquote>
<p>​	一个事务把另一个对数据的已修改结果覆盖，导致这些修改好像丢失了一样</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930204533537.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930204533537.png" class="lozad post-image"></p>
<blockquote>
<p>2.读取脏数据(脏读)</p>
</blockquote>
<p>​	一个事务读取了另一个事务未提交的数据，会造成两个事务得到的数据不一致</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930205018833.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930205018833.png" class="lozad post-image"></p>
<blockquote>
<p>3.不可重复读</p>
</blockquote>
<p>​	一个事务对同一数据的读取结果前后不一致，这是由于读取了另一个事务已修改提交的数据。当其中一个事务需要校验或再确认数据时，出现再读数据与之前读的数据值不相同。(侧重读-读)</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930205136157.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930205136157.png" class="lozad post-image"></p>
<blockquote>
<p>4.幻象读(Phantom Read)(幻读)</p>
</blockquote>
<p>读到的数据是不真实的。比如select 某记录是否存在，不存在，准备插入此记录，但执行 insert 时发现此记录已存在，无法插入，此时就发生了幻读。(侧重读-写)</p>
<p>原因：其他事务修改、插入、删除了数据。</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930205420783.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930205420783.png" class="lozad post-image"></p>
<h3 id="4-事务的隔离级别"><a class="markdownIt-Anchor" href="#4-事务的隔离级别"></a> 4. 事务的隔离级别</h3>
<p>产生上述四种数据不一致性问题的主要原因是并发的事务操作<strong>破坏了事务的隔离性</strong>。</p>
<p>为了防止数据库的并发操作导致的数据库不一致性问题，SQL标准定义了4种隔离级别：</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930210940379.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930210940379.png" class="lozad post-image"></p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> @<span class="token variable">@transaction_isolation</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">-- MySQL数据库支持所有的隔离级别，查询当前事务隔离级别的语句</span>

<span class="token comment" spellcheck="true">-- 设置当前事务的隔离级别(两种方式)</span>
<span class="token keyword">SET</span> <span class="token punctuation">[</span><span class="token keyword">global</span> <span class="token operator">|</span> <span class="token keyword">session</span><span class="token punctuation">]</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation level</span> 隔离级别名称<span class="token punctuation">;</span>
	<span class="token comment" spellcheck="true">#global隔离级用于所有用户，session隔离级只用于当前对话和连接</span>
<span class="token keyword">SET</span> transaction_isolation<span class="token operator">=</span>’隔离级别名称’<span class="token punctuation">;</span>

</code></pre>
<blockquote>
<ol>
<li>读取未提交事务</li>
</ol>
</blockquote>
<p>READ UNCOMMITTED是<strong>最低</strong>事务隔离级别，<strong>无法避免读取脏数据、不可重复读和幻象读</strong>。</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 设置当前会话隔离级别</span>
<span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation level</span> <span class="token keyword">read</span> <span class="token keyword">uncommitted</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<ol start="2">
<li>读取提交的事务</li>
</ol>
</blockquote>
<p>read committed可以避免读取脏数据，但<strong>不可避免不可重复读和幻象读</strong>。</p>
<blockquote>
<ol start="3">
<li>可重复读</li>
</ol>
</blockquote>
<p>REPEATABLE READ是<strong>MySQL默认</strong>的隔离级别，确保同一事务内执行相同的查询语句时，读取的结果是一致的。如果事务T2对<strong>多行数据</strong>进行增加，那么将会出现<strong>幻象读</strong>的问题。</p>
<blockquote>
<ol start="4">
<li>串行化</li>
</ol>
</blockquote>
<p>SERIALIZABL通过强制事务排序，使事务之间不可能相互冲突。用户之间一个接一个顺序地执行当前事务，从而解决幻象读问题，但是可能导致<strong>大量的等待现象。</strong></p>
<h3 id="5-事务隔离性的实现"><a class="markdownIt-Anchor" href="#5-事务隔离性的实现"></a> 5. 事务隔离性的实现</h3>
<p>按照其对可能重读的操作采取的不同策略可以分为乐观并发控制和悲观并发控制两大类。</p>
<p><strong>乐观并发控制</strong>：对于并发执行可能冲突的操作，假定其不会真的冲突，允许并发执行，直到真正发生冲突时才去解决冲突，比如让事务回滚。</p>
<p><strong>悲观并发控制</strong>：对于并发执行可能冲突的操作，假定其必定发生冲突。</p>
<h3 id="6-封锁及封锁协议"><a class="markdownIt-Anchor" href="#6-封锁及封锁协议"></a> 6. 封锁及封锁协议</h3>
<p>封锁是一种用来防止多个事务同时访问数据而产生问题的机制。</p>
<p>封锁可以防止用户读取正在由其他用户修改的数据，并可以防止多个用户同时更改相同数据。</p>
<p>事务T在对某个数据对象（例如表、记录等）操作之前，先向系统发出请求，对其加锁。加锁后事务T对该数据对象就有了一定的控制，在事务T释放它的锁之前，其他事务不能更新该数据。</p>
<h4 id="1-封锁粒度"><a class="markdownIt-Anchor" href="#1-封锁粒度"></a> 1. 封锁粒度</h4>
<p><strong>封锁粒度</strong>：封锁的数据库对象的大小。锁定的数据量越少，发生锁争用的可能就越小。在mysql中，封锁粒度分为<strong>行级锁</strong>和<strong>表级锁</strong>。</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930215541528.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930215541528.png" class="lozad post-image"></p>
<h4 id="2-封锁类型"><a class="markdownIt-Anchor" href="#2-封锁类型"></a> 2. 封锁类型</h4>
<p>封锁分为<strong>排它锁</strong>和<strong>共享锁</strong>两种。</p>
<p>排它锁(eXclusive lock)，简称X锁，又称独占锁或写锁。</p>
<p>排它锁确保不会同时对同一资源进行多重更新。</p>
<p>共享锁(shared lock)，简称S锁，又称读锁。</p>
<p>共享锁允许并发事务读取同一个资源。资源上存在共享锁时，任何其他事务都不能修改数据。除非将事务隔离级别设置为可重复读或更高级别，或者在事务生存周期内用锁定提示保留共享锁，那么一旦读取数据，便立即释放资源上的共享锁。</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930220142395.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930220142395.png" class="lozad post-image"></p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930220217492.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930220217492.png" class="lozad post-image"></p>
<h4 id="3-封锁协议"><a class="markdownIt-Anchor" href="#3-封锁协议"></a> 3. 封锁协议</h4>
<p>在封锁时约定的一些规则，例如何时申请封锁、申请何种锁、持锁时间、何时释放等，被称为封锁协议（Locking Protocol）。</p>
<blockquote>
<p>一级封锁协议：</p>
</blockquote>
<p>​	事务T在修改数据A时必须先对其加X锁，直到事务结束才能释放锁。</p>
<p>​	防止丢失更新。</p>
<blockquote>
<p>二级封锁协议：</p>
</blockquote>
<p>在一级封锁协议的基础上，加上事务T在读取数据R之前必须先对其加S锁，读完后释放S锁。</p>
<p>​	防止丢失更新，读脏数据。</p>
<blockquote>
<p>三级封锁协议：</p>
</blockquote>
<p>​	在一级封锁协议的基础上，加上事务T在读取数据R之前必须先对其加S锁，读完后并不释放S锁，而直到事务T结束才释放。</p>
<p>​	防止丢失更新，读脏数据，不可重复读。</p>
<h4 id="4-死锁和活锁"><a class="markdownIt-Anchor" href="#4-死锁和活锁"></a> 4. 死锁和活锁</h4>
<p>死锁（Dead Lock）是指两个或更多的事务<strong>同时处于等待状态</strong>，每个事务都在等待其中另一个事务解除封锁，它才能继续执行下去，结果造成任何一个事务都无法继续执行。</p>
<table>
<thead>
<tr>
<th>时  间</th>
<th>事务T1</th>
<th>事务T2</th>
</tr>
</thead>
<tbody>
<tr>
<td>t0</td>
<td>封锁学生表</td>
<td></td>
</tr>
<tr>
<td>t1</td>
<td></td>
<td>封锁成绩表</td>
</tr>
<tr>
<td>t2</td>
<td>要求封锁成绩表，等待</td>
<td></td>
</tr>
<tr>
<td>t3</td>
<td></td>
<td>要求封锁学生表，等待</td>
</tr>
<tr>
<td>t4</td>
<td>等待</td>
<td>等待</td>
</tr>
</tbody>
</table>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930222240860.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930222240860.png" class="lozad post-image"></p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930222325713.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20230930222325713.png" class="lozad post-image"></p>
<p>活锁（Live Lock）是指由于其他事务的封锁操作使某个事务永远处于等待状态，得不到继续操作的机会。</p>
<p>​	活锁避免的方法就是采用先来先服务的策略，按照请求封锁的次序对事务进行排队。</p>
<h2 id="12-存储过程与函数"><a class="markdownIt-Anchor" href="#12-存储过程与函数"></a> 12. 存储过程与函数</h2>
<p>是一组完成特定功能的SQL语言代码段，经编译后存储在数据库中，可被触发器、其他存储过程、程序设计语言所调用。</p>
<h3 id="1-定界符与语句块"><a class="markdownIt-Anchor" href="#1-定界符与语句块"></a> 1. 定界符与语句块</h3>
<p>​	mysql默认定界符<code>;</code>，可用delimiter命令新建定界符</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">DELIMITER</span> $$
<span class="token comment" spellcheck="true">#表示新的定界符为“$$”，自此开始，直到遇到下一个“$$”，MySQL才会整体执行这段语句代码。</span>
</code></pre>
<p>​	语句块是由若干条语句构成的程序代码单元，在逻辑上被当作一个整体，语句块中的语句要么被执行，要么整体都不被执行。</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#用begin...end定义一个语句块</span>
</code></pre>
<h3 id="2-变量定义与使用"><a class="markdownIt-Anchor" href="#2-变量定义与使用"></a> 2. 变量定义与使用</h3>
<p>变量具有<strong>变量名，变量值，数据类型</strong>。</p>
<p>变量分为<strong>用户会话变量，局部变量，系统变量</strong>。</p>
<blockquote>
<p>用户会话变量@</p>
</blockquote>
<p>默认值为NULL，无需给出数据类型</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">set</span> <span class="token variable">@a</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token variable">@b</span><span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@c</span>:<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token variable">@d</span>:<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@e</span>:<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token variable">@f</span>:<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token variable">@a</span><span class="token punctuation">,</span><span class="token variable">@b</span> <span class="token keyword">from</span> sc<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>局部变量</p>
</blockquote>
<p>在一个语句块内部定义的变量。</p>
<p>定义存储过程时，所有局部变量的声明一定要放在存储过程体的开始</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">declare</span> total_num <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> x<span class="token punctuation">,</span>y <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> myname char<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>系统变量@@</p>
</blockquote>
<p>分为<strong>全局变量和会话变量</strong></p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#查询所有全局变量</span>
<span class="token keyword">show</span> <span class="token keyword">global</span> variables<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#查询所有会话变量</span>
<span class="token keyword">show</span> <span class="token keyword">session</span> variables<span class="token punctuation">;</span>
<span class="token keyword">show</span> variables<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#查询某个系统变量的取值</span>
<span class="token keyword">select</span> @<span class="token variable">@global.wait_timeout</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 全局变量wait_timeout</span>
<span class="token keyword">select</span> @<span class="token variable">@session.version</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 会话变量version</span>
<span class="token keyword">select</span> @<span class="token variable">@version</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 优先查会话变量，再查全局变量</span>
<span class="token comment" spellcheck="true">#修改会话变量的值</span>
</code></pre>
<h3 id="3-存储过程的创建和调用"><a class="markdownIt-Anchor" href="#3-存储过程的创建和调用"></a> 3. 存储过程的创建和调用</h3>
<h4 id="1-创建"><a class="markdownIt-Anchor" href="#1-创建"></a> 1. 创建</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span>
    <span class="token punctuation">[</span><span class="token keyword">DEFINER</span> <span class="token operator">=</span> { <span class="token keyword">user</span> <span class="token operator">|</span> <span class="token keyword">CURRENT_USER</span> }<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true">#定义DEFINER,默认为当前用户</span>
<span class="token keyword">PROCEDURE</span> 存储过程名
    <span class="token punctuation">[</span>SQL SECURITY { <span class="token keyword">DEFINER</span> <span class="token operator">|</span> <span class="token keyword">INVOKER</span> } <span class="token operator">|</span> …<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#指定DEFINER或INVOKER权限</span>
<span class="token keyword">BEGIN</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">END</span>
</code></pre>
<blockquote>
<p>创建存储过程，计算阶乘</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#记得要声明分隔符</span>
<span class="token keyword">drop</span> <span class="token keyword">procedure</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> p1<span class="token punctuation">;</span>
<span class="token keyword">delimiter</span> $$
<span class="token keyword">create</span> <span class="token keyword">procedure</span> p1<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#无参构造</span>
<span class="token keyword">begin</span>
<span class="token keyword">declare</span> n<span class="token punctuation">,</span>m <span class="token keyword">int</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">#"局部变量"</span>
<span class="token keyword">set</span> n<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> m<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> n<span class="token operator">&lt;=</span><span class="token number">10</span> <span class="token keyword">do</span> 
<span class="token keyword">set</span> m<span class="token operator">=</span>m<span class="token operator">*</span>n<span class="token punctuation">;</span>
<span class="token keyword">set</span> n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> m<span class="token punctuation">;</span>
<span class="token keyword">end</span>$$
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#恢复默认分隔符</span>
<span class="token comment" spellcheck="true">#调用存储过程</span>
<span class="token keyword">call</span> p1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>存储过程的形参</p>
</blockquote>
<p>in 表示输入参数，调用时必须传入一个确定的值或有确定值的变量。不会影响传入的外部变量(不能被返回)。</p>
<p>out 表示输出参数，调用时必须传入一个用户会话变量，会影响传入的外部变量</p>
<p>inout 表示输入输出参数，调用时必须传入一个有确定值的用户会话变量，会影响传入的外部变量</p>
<p><strong>注意</strong>：out，inout不接受系统变量作为实参。</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">delimiter</span> $$
<span class="token keyword">create</span> <span class="token keyword">procedure</span> p1<span class="token punctuation">(</span><span class="token keyword">out</span> <span class="token number">a</span> char<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
<span class="token keyword">set</span> <span class="token variable">@a</span><span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#用户会话变量</span>
<span class="token keyword">set</span> <span class="token number">a</span><span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#存储过程局部变量</span>
<span class="token keyword">select</span> <span class="token variable">@a</span><span class="token punctuation">,</span><span class="token number">a</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>$$
mysql<span class="token operator">></span> <span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
mysql<span class="token operator">></span> <span class="token keyword">set</span> <span class="token variable">@a</span><span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token variable">@b</span><span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span>
mysql<span class="token operator">></span> <span class="token keyword">call</span> p1<span class="token punctuation">(</span><span class="token variable">@b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">#调用存储过程，传入实参</span>
mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token variable">@a</span><span class="token punctuation">,</span><span class="token variable">@b</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#此时@a=40,@b=80</span>
</code></pre>
<h4 id="2-查看修改特性删除"><a class="markdownIt-Anchor" href="#2-查看修改特性删除"></a> 2. 查看，修改特性，删除</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#查看存储过程的定义</span>
<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">procedure</span> p1<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#查看存储过程的状态特征</span>
<span class="token keyword">show</span> <span class="token keyword">procedure</span> <span class="token keyword">status</span> <span class="token operator">like</span> <span class="token string">"p%"</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#只能修改存储过程的特性</span>
<span class="token keyword">alter</span> <span class="token keyword">procedure</span> p1  <span class="token keyword">comment</span> <span class="token string">'改名了'</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">procedure</span> p1 sql security <span class="token keyword">invoker</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#删除</span>
<span class="token keyword">drop</span> <span class="token keyword">procedure</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> p1<span class="token punctuation">;</span>
</code></pre>
<h3 id="4-存储过程相关函数"><a class="markdownIt-Anchor" href="#4-存储过程相关函数"></a> 4. 存储过程相关函数</h3>
<table>
<thead>
<tr>
<th>case when…then…when…then…else…end case;</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>while…do…end while;</td>
<td></td>
</tr>
<tr>
<td>[label:] loop…end loop [label];</td>
<td>一直循环直到执行leave [label];</td>
</tr>
<tr>
<td>[label:] repeat…until…end repeat [label];</td>
<td>类似do-while</td>
</tr>
</tbody>
</table>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">DELIMITER</span> <span class="token comment" spellcheck="true">//</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span> 
	<span class="token keyword">DECLARE</span> id <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
	add_loop:LOOP
		<span class="token keyword">IF</span> id <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> id <span class="token operator">=</span> id <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">ELSE</span>
		   LEAVE add_loop<span class="token punctuation">;</span>
		<span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
	<span class="token keyword">END</span> LOOP add_loop<span class="token punctuation">;</span>
	<span class="token keyword">SELECT</span> id<span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment" spellcheck="true">//</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
<span class="token keyword">CALL</span> test_loop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="5-用户自定义函数"><a class="markdownIt-Anchor" href="#5-用户自定义函数"></a> 5. 用户自定义函数</h3>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#因为开启了二进制日志，所以得设一下下面这个变量</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> log_bin_trust_function_creators<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">delimiter</span> <span class="token comment" spellcheck="true">//</span>
<span class="token keyword">create</span> <span class="token keyword">function</span> <span class="token punctuation">`</span>pt1<span class="token punctuation">`</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">returns</span> <span class="token keyword">int</span>
<span class="token keyword">begin</span>
<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token comment" spellcheck="true">//</span>
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
<span class="token keyword">select</span> pt1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">#调用函数</span>
</code></pre>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#查看状态特征</span>
<span class="token keyword">show</span> <span class="token keyword">function</span> <span class="token keyword">status</span><span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">function</span> <span class="token keyword">status</span> <span class="token operator">like</span> <span class="token string">"pt1"</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#查看函数代码</span>
<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">function</span> pt1<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#修改特征信息</span>
<span class="token keyword">alter</span> <span class="token keyword">function</span> pt1 sql security <span class="token keyword">invoker</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#删除函数</span>
<span class="token keyword">drop</span> <span class="token keyword">function</span> pt1<span class="token punctuation">;</span>
</code></pre>
<h3 id="6-游标-cursor"><a class="markdownIt-Anchor" href="#6-游标-cursor"></a> 6. 游标 cursor</h3>
<p>游标实际上是一种能从包括多条数据记录的结果集中逐条访问这些记录的机制。</p>
<p>游标主要包括结果集和游标位置。</p>
<p>MySQL游标只能用于存储过程和函数。</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#游标声明</span>
<span class="token keyword">DECLARE</span> emp_c <span class="token keyword">CURSOR</span> <span class="token keyword">FOR</span> <span class="token keyword">SELECT</span> salary <span class="token keyword">FROM</span> employees <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#打开游标</span>
<span class="token keyword">open</span> emp_c<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#提取数据</span>
<span class="token comment" spellcheck="true">#fetch取出一条记录，游标指针自动向后移动并指向下一条记录。</span>
<span class="token keyword">FETCH</span> emp_c <span class="token keyword">INTO</span> cursor_salary<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#关闭游标</span>
<span class="token keyword">close</span> emp_c<span class="token punctuation">;</span>
</code></pre>
<h2 id="13-数据库备份还原和日志管理"><a class="markdownIt-Anchor" href="#13-数据库备份还原和日志管理"></a> 13. 数据库备份还原和日志管理</h2>
<h3 id="1-简介"><a class="markdownIt-Anchor" href="#1-简介"></a> 1. 简介</h3>
<blockquote>
<p>数据库备份分类</p>
</blockquote>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20231001164436742.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20231001164436742.png" class="lozad post-image"></p>
<blockquote>
<p>mysql常用数据库备份工具</p>
</blockquote>
<p>mysqldump 逻辑备份工具</p>
<p>mysqlhotcopy 仅支持MyISAM</p>
<h3 id="2-mysqldump命令备份"><a class="markdownIt-Anchor" href="#2-mysqldump命令备份"></a> 2. mysqldump命令备份</h3>
<p><strong>注意</strong>：要用cmd，而不是power shell，不然导入不了。</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20231001165821721.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20231001165821721.png" class="lozad post-image"></p>
<pre class=" language-bash"><code class="language-bash">chcp 65001
<span class="token comment" spellcheck="true">#登录用户主机为本地，将数据库db1中的teacher表备份到back_file1.sql下</span>
mysqldump -u root -h 127.0.0.1 -proot db1 teacher <span class="token operator">></span> C:\databasestudy\back_file1.sql

<span class="token comment" spellcheck="true">#备份所有表</span>
mysqldump -u root -h 127.0.0.1 -proot db1  <span class="token operator">></span> C:\databasestudy\back_file2.sql

<span class="token comment" spellcheck="true">#备份表结构</span>
mysqldump -u root -h 127.0.0.1 -proot --opt --no-data db1 teacher  <span class="token operator">></span> C:\databasestudy\back_file3.sql

<span class="token comment" spellcheck="true">#备份多个表</span>
mysqldump -u root -h 127.0.0.1 -proot  db1 teacher student  <span class="token operator">></span> C:\databasestudy\back_file4.sql

<span class="token comment" spellcheck="true">#备份数据库db1,db2</span>
mysqldump -u root -h 127.0.0.1 -proot --databases db1 db2  <span class="token operator">></span> C:\databasestudy\back_file5.sql

<span class="token comment" spellcheck="true">#备份所有数据库</span>
mysqldump -u root -h 127.0.0.1 -proot --all-databases   <span class="token operator">></span> C:\databasestudy\back_file6.sql

<span class="token comment" spellcheck="true">#备份数据库结构</span>
mysqldump -u root -h 127.0.0.1 -proot --opt --no-data  db1  <span class="token operator">></span> C:\databasestudy\back_file7.sql

<span class="token comment" spellcheck="true">#备份数据库数据</span>
mysqldump -u root -h 127.0.0.1 -proot --opt --no-create-info  db1  <span class="token operator">></span> C:\databasestudy\back_file8.sql

<span class="token comment" spellcheck="true">#备份部分数据</span>
mysqldump -u root -h 127.0.0.1 -proot db1 test1 --where<span class="token operator">=</span><span class="token string">"age&lt;11"</span>  <span class="token operator">></span> C:\databasestudy\back_file9.sql
</code></pre>
<h3 id="3-备份还原"><a class="markdownIt-Anchor" href="#3-备份还原"></a> 3. 备份还原</h3>
<blockquote>
<p>未登录服务器用mysql命令还原</p>
</blockquote>
<pre class=" language-bash"><code class="language-bash">mysqldump -u root -h 127.0.0.1 -proot  db1 test2 <span class="token operator">></span> C:\databasestudy\back_file11.sql

mysql -u root  -p db2 <span class="token operator">&lt;</span>C:\databasestudy\back_file11.sql -- 还原
/*navicat有延时，需要过一段时间再刷新才能看到
据说是本地缓存机制
在cmd登录数据库查看没这个问题*/
</code></pre>
<blockquote>
<p>登陆服务器用source命令还原</p>
</blockquote>
<pre class=" language-sql"><code class="language-sql">mysqldump <span class="token operator">-</span>u root <span class="token operator">-</span>h <span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span> <span class="token operator">-</span>proot  <span class="token number">db1</span> test2 <span class="token operator">></span> C:\databasestudy\back_file11<span class="token punctuation">.</span>sql
mysql <span class="token operator">-</span>u root <span class="token operator">-</span>p
<span class="token keyword">use</span> <span class="token number">db2</span><span class="token punctuation">;</span>
source  C:\databasestudy\back_file11<span class="token punctuation">.</span>sql <span class="token comment" spellcheck="true">#这里不能有;号</span>
</code></pre>
<h3 id="4-mysql日志管理"><a class="markdownIt-Anchor" href="#4-mysql日志管理"></a> 4. mysql日志管理</h3>
<p><strong>注意</strong>：cmd里chcp 65001</p>
<p>​	日志文件中记录着MySQL数据库运行期间发生的变化；也就是说用来记录MySQL数据库的客户端连接状况、SQL语句的执行情况和错误信息等。</p>
<p>日志文件分为：错误日志，二进制日志，通用查询日志，慢查询日志。</p>
<p><img src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20231002131719983.png" alt srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/image-20231002131719983.png" class="lozad post-image"></p>
<h4 id="1-错误日志"><a class="markdownIt-Anchor" href="#1-错误日志"></a> 1. 错误日志</h4>
<p>默认开启，不能禁止。文件名格式为hostname.err。</p>
<p>my.ini中：</p>
<p>log-err定义错误日志的存储位置</p>
<p>log-warnings定义是否将警告信息写入错误日志。</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#查看错误日志所在目录及文件名</span>
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%log_error%'</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#删除错误日志(重新加载日志)</span>
mysqladmin <span class="token operator">-</span>u root <span class="token operator">-</span>p flush<span class="token operator">-</span>logs
</code></pre>
<h4 id="2-二进制日志"><a class="markdownIt-Anchor" href="#2-二进制日志"></a> 2. 二进制日志</h4>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#查看是否开启</span>
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%log_bin%'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#通过my.ini文件中的log-bin选项可以开启二进制日志</span>
log<span class="token operator">-</span>bin <span class="token punctuation">[</span><span class="token operator">=</span>path<span class="token operator">/</span><span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">#路径</span>
expire_logs_days<span class="token operator">=</span><span class="token number">10</span> <span class="token comment" spellcheck="true">#保留时间</span>
max_binlog_size<span class="token operator">=</span>100M <span class="token comment" spellcheck="true">#单个文件大小限制</span>
</code></pre>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#登陆后查看有哪些二进制日志</span>
<span class="token keyword">show</span> <span class="token keyword">binary</span> logs<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#查看日志</span>
mysqlbinlog <span class="token number">d</span>:<span class="token operator">/</span>log<span class="token operator">/</span>DESKTOP<span class="token operator">-</span>O5KMGM8<span class="token operator">-</span>bin<span class="token number">.000013</span> 
</code></pre>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#删除二进制日志</span>
<span class="token keyword">PURGE</span> <span class="token keyword">BINARY</span> LOGS BEFORE <span class="token string">'2008-04-02 22:46:26'</span><span class="token punctuation">;</span>
	<span class="token comment" spellcheck="true">#删除到某个时间前所有日志</span>
<span class="token keyword">PURGE</span> <span class="token keyword">BINARY</span> LOGS <span class="token keyword">TO</span> <span class="token string">'mysql-bin.010'</span><span class="token punctuation">;</span>
	<span class="token comment" spellcheck="true">#删除到某个日志前(不包括指定日志)</span>
</code></pre>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#使用mysqlbinlog恢复数据库到某一时刻的状态</span>
mysqlbinlog <span class="token comment" spellcheck="true">--stop-datetime=”2021-03-10 10:00:00” C:\ProgramData\MySQL\MySQL Server 8.0\Data\DESKTOP-TKC62RP-bin.000005 | mysql -u root -p</span>
<span class="token comment" spellcheck="true">-- 必须是编号小的先还原</span>
</code></pre>
<p>start-datetime、stop-datetime表示恢复数据库的起始时间点和结束时间点。 start-position和stop-position表示恢复数据的开始位置和结束位置。</p>
<h4 id="3-慢查询日志"><a class="markdownIt-Anchor" href="#3-慢查询日志"></a> 3. 慢查询日志</h4>
<p>慢查询日志在MySQL中默认是关闭的，可以通过配置文件my.ini或者my.cnf中的slow_query_log选项打开。</p>
<p>slow_query_log_file[=path/[filename]]  路径，默认hostname-slow.log</p>
<p>long_query_time=n 查询时间超过n则记录，默认10秒</p>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#可以在登陆后开启</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> slow_query_log<span class="token operator">=</span><span class="token keyword">on</span><span class="token punctuation">;</span>或
<span class="token keyword">set</span> <span class="token keyword">global</span> slow_query_log<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#查看慢查询定义的时间值</span>
<span class="token keyword">show</span> <span class="token keyword">global</span> variables <span class="token operator">like</span> <span class="token string">'long_query_time'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#查看慢查询日志相关变量</span>
<span class="token keyword">show</span> <span class="token keyword">global</span> variables <span class="token operator">like</span> <span class="token string">'%slow_query_log%'</span><span class="token punctuation">;</span>
</code></pre>
<pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#删除慢查询日志</span>
mysqladmin <span class="token operator">-</span>u root <span class="token operator">-</span>p flush<span class="token operator">-</span>logs<span class="token punctuation">;</span>
</code></pre>
<h4 id="4-通用日志管理"><a class="markdownIt-Anchor" href="#4-通用日志管理"></a> 4. 通用日志管理</h4>
<p>默认关闭，可修改my.ini开启，log[=path/[filename]]</p>
<p>也可在登陆后在set global general_log=on/1;</p>
<p>show variables like ‘general%’;</p>
<p>windows用记事本打开查看。</p>
<pre class=" language-sql"><code class="language-sql">mysqladmin <span class="token operator">-</span>u root <span class="token operator">-</span>p flush<span class="token operator">-</span>logs<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#重设日志</span>
flush logs<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#登陆后重设日志</span>
</code></pre>
<h2 id="中英对照"><a class="markdownIt-Anchor" href="#中英对照"></a> 中英对照</h2>
<p>cascade 级联 n.  [kæˈskeɪd]</p>
<p>constraint 约束 n.   [kənˈstreɪnt]</p>
<p>delimiter 定界符 n. [dɪ’lɪmɪtə]</p>
<p>exclusive 排斥的，专有的 adj. [ɪkˈskluːsɪv]</p>
<p>phantom 幽灵,幻影 n. [ˈfæntəm]</p>
<p>privilege 特权 n. [ˈprɪvəlɪdʒ]</p>
<p>procedure 程序，步骤 n. [prəˈsiːdʒə®]</p>
<p>protocol 协议 n. [ˈprəʊtəkɒl]</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>charlist <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>

  </div>
  <div>
    
      <div 
        class="post-note note-warning copyright" 
        style="margin-top: 42px">
        <p>
          <span style="font-weight: bold;">作者：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="/about">
            jkloli
          </a>
        </p>
        <p>
          <span style="font-weight: bold;">文章链接：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="https://eyjafjalla6.github.io/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/">
            https://eyjafjalla6.github.io/2023/08/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86mysql%E7%89%88/
          </a>
        </p>
        <p><span style="font-weight: bold;">版权声明：</span>本博客所有文章除特别声明外，均采用<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0 协议</a>。转载请注明出处！</p>
      </div>
    
  </div>
</article>
<div class="nav">
  
    <div class="nav-item-prev">
      <a 
        href="/2023/08/24/%E6%B5%8B%E8%AF%95/" 
        class="nav-link">
        <i class="iconfont icon-left nav-prev-icon"></i>
        <div>
          <div class="nav-label">上一篇</div>
          
            <div class="nav-title">测试 </div>
          
        </div>
      </a>
    </div>
  
  
    <div class="nav-item-next">
      <a 
        href="/2023/07/14/python%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" 
        class="nav-link">
        <div>
          <div class="nav-label">下一篇</div>
          
            <div class="nav-title">python学习笔记 </div>
          
        </div>
        <i class="iconfont icon-right nav-next-icon"></i>
      </a>
    </div>
  
</div>

<div 
  class="card card-content toc-card" 
  id="mobiletoc">
  <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86"><span class="toc-text"> 数据库原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="toc-text"> 0. 问题解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-text"> 1. 环境配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A6%82%E8%BF%B0"><span class="toc-text"> 2. 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5"><span class="toc-text"> 1. 一些概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E7%BB%86%E7%A2%8E%E7%9A%841"><span class="toc-text"> 比较细碎的1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E4%B8%96%E7%95%8C%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text"> 信息世界基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 数据模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E7%BB%86%E7%A2%8E%E7%9A%842"><span class="toc-text"> 比较细碎的2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-e-r%E5%9B%BE"><span class="toc-text"> 2. E-R图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 3. 数据库类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-text"> 4. 常见的数据库管理系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-mysql%E4%BB%8B%E7%BB%8D"><span class="toc-text"> 5. MySQL介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-sql%E6%A6%82%E8%BF%B0"><span class="toc-text"> 6. SQL概述</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-navicat%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C"><span class="toc-text"> 2. navicat基础操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8navicat%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text"> 1. 使用navicat创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5%E5%B1%9E%E6%80%A7"><span class="toc-text"> 2. 修改字段属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-text"> 3. 添加数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9F%A5%E8%AF%A2%E8%A1%A8"><span class="toc-text"> 4. 查询表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%A4%87%E4%BB%BD%E5%92%8C%E8%BF%98%E5%8E%9F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text"> 5. 备份和还原数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 3. 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 1. 数字类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BA%8B%E4%BB%B6%E5%92%8C%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 2. 事件和日期类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 3. 字符串类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-json%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 4. JSON数据类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-sql%E5%88%86%E7%B1%BB%E8%AF%A6%E8%A7%A3"><span class="toc-text"> 4. SQL分类详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-ddl-%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80"><span class="toc-text"> 1. DDL 数据定义语言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-text"> 1. 数据库操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%A1%A8%E6%93%8D%E4%BD%9C%E9%87%8D%E8%A6%81"><span class="toc-text"> 2. 表操作（重要）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-dml%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C%E8%AF%AD%E8%A8%80"><span class="toc-text"> 2. DML（数据操作语言）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE-insert"><span class="toc-text"> 1. 添加数据 insert</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text"> 注意事项</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9B%B4%E6%96%B0%E5%92%8C%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AEupdatedelete"><span class="toc-text"> 2. 更新和删除数据update,delete</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-dql%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-text"> 3. DQL（数据查询语言）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2-select"><span class="toc-text"> 1. 基础查询 select</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2-where"><span class="toc-text"> 2. 条件查询 where</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2countavg"><span class="toc-text"> 3. 聚合查询count,avg…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2group-by"><span class="toc-text"> 4. 分组查询group by</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2order-by"><span class="toc-text"> 5. 排序查询order by</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2limit"><span class="toc-text"> 6. 分页查询limit</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-2"><span class="toc-text"> 注意事项</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E6%93%8D%E4%BD%9C"><span class="toc-text"> 实际操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-dcl"><span class="toc-text"> 4. DCL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%AE%A1%E7%90%86%E7%94%A8%E6%88%B7"><span class="toc-text"> 1. 管理用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-text"> 2. 权限控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-mysql%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text"> 5. mysql正则表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E5%87%BD%E6%95%B0"><span class="toc-text"> 6.函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-text"> 1. 字符串函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-text"> 2. 数值函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-text"> 3. 日期函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%87%BD%E6%95%B0"><span class="toc-text"> 4. 系统信息函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%B5%81%E7%A8%8B%E5%87%BD%E6%95%B0"><span class="toc-text"> 5. 流程函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E7%BA%A6%E6%9D%9F"><span class="toc-text"> 7. 约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%B8%B8%E8%A7%81%E7%BA%A6%E6%9D%9F"><span class="toc-text"> 1. 常见约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9Fforeign-key"><span class="toc-text"> 2. 外键约束foreign key</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%A4%96%E9%94%AE"><span class="toc-text"> 1. 创建外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E5%A4%96%E9%94%AE"><span class="toc-text"> 2. 查看外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%BF%AE%E6%94%B9%E5%92%8C%E5%88%A0%E9%99%A4%E5%A4%96%E9%94%AE"><span class="toc-text"> 3. 修改和删除外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%90%AF%E7%94%A8%E6%88%96%E7%A6%81%E7%94%A8%E5%A4%96%E9%94%AE"><span class="toc-text"> 4. 启用或禁用外键</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%87%AA%E5%8A%A8%E5%A2%9E%E9%95%BF"><span class="toc-text"> 3. 自动增长</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 8. 多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A4%9A%E8%A1%A8%E5%85%B3%E7%B3%BB"><span class="toc-text"> 1. 多表关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%90%88%E5%B9%B6%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 2. 合并查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 3. 内连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 4. 外连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 5. 自连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2unionunion-all"><span class="toc-text"> 6. 联合查询union，union all</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 7. 子查询(嵌套查询)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%A0%87%E9%87%8F%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 1. 标量子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%97%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 2. 列子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 3. 行子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%A1%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 4. 表子查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E8%A7%86%E5%9B%BE%E4%B8%8E%E7%B4%A2%E5%BC%95"><span class="toc-text"> 9. 视图与索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%A7%86%E5%9B%BE"><span class="toc-text"> 1. 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%A7%86%E5%9B%BE%E5%88%9B%E5%BB%BA"><span class="toc-text"> 1. 视图创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%A7%86%E5%9B%BE%E7%AE%A1%E7%90%86"><span class="toc-text"> 2. 视图管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95"><span class="toc-text"> 2. 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%B4%A2%E5%BC%95%E5%88%9B%E5%BB%BA"><span class="toc-text"> 1. 索引创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95%E7%AE%A1%E7%90%86"><span class="toc-text"> 2. 索引管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86"><span class="toc-text"> 10. 数据库安全管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7"><span class="toc-text"> 1. 添加用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-text"> 2. 用户管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-text"> 3. 权限管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86"><span class="toc-text"> 4. 角色管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%B0%81%E9%94%81"><span class="toc-text"> 11. 数据库并发控制与封锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E6%80%A7%E7%9A%84%E5%90%AB%E4%B9%89"><span class="toc-text"> 1. 数据库并发性的含义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BA%8B%E5%8A%A1%E5%8F%8A%E5%85%B6%E6%80%A7%E8%B4%A8"><span class="toc-text"> 2. 事务及其性质</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-mysql%E6%94%AF%E6%8C%814%E7%A7%8D%E4%BA%8B%E5%8A%A1%E6%A8%A1%E5%BC%8F"><span class="toc-text"> 1. Mysql支持4种事务模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%80%A7%E8%B4%A8%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7acid"><span class="toc-text"> 2. 事务的性质（四大特性ACID）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E7%9A%84%E6%A8%A1%E5%BC%8F"><span class="toc-text"> 3. 用户定义的模式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%9A%84%E4%B8%8D%E4%B8%80%E8%87%B4%E6%80%A7"><span class="toc-text"> 3. 并发控制与数据的不一致性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-text"> 4. 事务的隔离级别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E6%80%A7%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text"> 5. 事务隔离性的实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%B0%81%E9%94%81%E5%8F%8A%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-text"> 6. 封锁及封锁协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B0%81%E9%94%81%E7%B2%92%E5%BA%A6"><span class="toc-text"> 1. 封锁粒度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B0%81%E9%94%81%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 2. 封锁类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-text"> 3. 封锁协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%AD%BB%E9%94%81%E5%92%8C%E6%B4%BB%E9%94%81"><span class="toc-text"> 4. 死锁和活锁</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0"><span class="toc-text"> 12. 存储过程与函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%9A%E7%95%8C%E7%AC%A6%E4%B8%8E%E8%AF%AD%E5%8F%A5%E5%9D%97"><span class="toc-text"> 1. 定界符与语句块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-text"> 2. 变量定义与使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E8%B0%83%E7%94%A8"><span class="toc-text"> 3. 存储过程的创建和调用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA"><span class="toc-text"> 1. 创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E4%BF%AE%E6%94%B9%E7%89%B9%E6%80%A7%E5%88%A0%E9%99%A4"><span class="toc-text"> 2. 查看，修改特性，删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-text"> 4. 存储过程相关函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-text"> 5. 用户自定义函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%B8%B8%E6%A0%87-cursor"><span class="toc-text"> 6. 游标 cursor</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E5%92%8C%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-text"> 13. 数据库备份还原和日志管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="toc-text"> 1. 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-mysqldump%E5%91%BD%E4%BB%A4%E5%A4%87%E4%BB%BD"><span class="toc-text"> 2. mysqldump命令备份</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F"><span class="toc-text"> 3. 备份还原</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-mysql%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-text"> 4. mysql日志管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97"><span class="toc-text"> 1. 错误日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97"><span class="toc-text"> 2. 二进制日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-text"> 3. 慢查询日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%80%9A%E7%94%A8%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-text"> 4. 通用日志管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E8%8B%B1%E5%AF%B9%E7%85%A7"><span class="toc-text"> 中英对照</span></a></li></ol></li></ol>
</div>
            </main>
            <aside class="right-column">
              <div class="sticky-widescreen">
  
  
    <article class="card card-content toc-card">
      <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86"><span class="toc-text"> 数据库原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="toc-text"> 0. 问题解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-text"> 1. 环境配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A6%82%E8%BF%B0"><span class="toc-text"> 2. 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5"><span class="toc-text"> 1. 一些概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E7%BB%86%E7%A2%8E%E7%9A%841"><span class="toc-text"> 比较细碎的1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E4%B8%96%E7%95%8C%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text"> 信息世界基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 数据模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E7%BB%86%E7%A2%8E%E7%9A%842"><span class="toc-text"> 比较细碎的2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-e-r%E5%9B%BE"><span class="toc-text"> 2. E-R图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 3. 数据库类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-text"> 4. 常见的数据库管理系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-mysql%E4%BB%8B%E7%BB%8D"><span class="toc-text"> 5. MySQL介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-sql%E6%A6%82%E8%BF%B0"><span class="toc-text"> 6. SQL概述</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-navicat%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C"><span class="toc-text"> 2. navicat基础操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8navicat%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text"> 1. 使用navicat创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5%E5%B1%9E%E6%80%A7"><span class="toc-text"> 2. 修改字段属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-text"> 3. 添加数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9F%A5%E8%AF%A2%E8%A1%A8"><span class="toc-text"> 4. 查询表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%A4%87%E4%BB%BD%E5%92%8C%E8%BF%98%E5%8E%9F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text"> 5. 备份和还原数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 3. 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 1. 数字类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BA%8B%E4%BB%B6%E5%92%8C%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 2. 事件和日期类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 3. 字符串类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-json%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 4. JSON数据类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-sql%E5%88%86%E7%B1%BB%E8%AF%A6%E8%A7%A3"><span class="toc-text"> 4. SQL分类详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-ddl-%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80"><span class="toc-text"> 1. DDL 数据定义语言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-text"> 1. 数据库操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%A1%A8%E6%93%8D%E4%BD%9C%E9%87%8D%E8%A6%81"><span class="toc-text"> 2. 表操作（重要）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-dml%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C%E8%AF%AD%E8%A8%80"><span class="toc-text"> 2. DML（数据操作语言）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE-insert"><span class="toc-text"> 1. 添加数据 insert</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text"> 注意事项</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9B%B4%E6%96%B0%E5%92%8C%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AEupdatedelete"><span class="toc-text"> 2. 更新和删除数据update,delete</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-dql%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-text"> 3. DQL（数据查询语言）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2-select"><span class="toc-text"> 1. 基础查询 select</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2-where"><span class="toc-text"> 2. 条件查询 where</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2countavg"><span class="toc-text"> 3. 聚合查询count,avg…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2group-by"><span class="toc-text"> 4. 分组查询group by</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2order-by"><span class="toc-text"> 5. 排序查询order by</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2limit"><span class="toc-text"> 6. 分页查询limit</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-2"><span class="toc-text"> 注意事项</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E6%93%8D%E4%BD%9C"><span class="toc-text"> 实际操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-dcl"><span class="toc-text"> 4. DCL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%AE%A1%E7%90%86%E7%94%A8%E6%88%B7"><span class="toc-text"> 1. 管理用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-text"> 2. 权限控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-mysql%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text"> 5. mysql正则表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E5%87%BD%E6%95%B0"><span class="toc-text"> 6.函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-text"> 1. 字符串函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-text"> 2. 数值函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-text"> 3. 日期函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%87%BD%E6%95%B0"><span class="toc-text"> 4. 系统信息函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%B5%81%E7%A8%8B%E5%87%BD%E6%95%B0"><span class="toc-text"> 5. 流程函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E7%BA%A6%E6%9D%9F"><span class="toc-text"> 7. 约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%B8%B8%E8%A7%81%E7%BA%A6%E6%9D%9F"><span class="toc-text"> 1. 常见约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9Fforeign-key"><span class="toc-text"> 2. 外键约束foreign key</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%A4%96%E9%94%AE"><span class="toc-text"> 1. 创建外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E5%A4%96%E9%94%AE"><span class="toc-text"> 2. 查看外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%BF%AE%E6%94%B9%E5%92%8C%E5%88%A0%E9%99%A4%E5%A4%96%E9%94%AE"><span class="toc-text"> 3. 修改和删除外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%90%AF%E7%94%A8%E6%88%96%E7%A6%81%E7%94%A8%E5%A4%96%E9%94%AE"><span class="toc-text"> 4. 启用或禁用外键</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%87%AA%E5%8A%A8%E5%A2%9E%E9%95%BF"><span class="toc-text"> 3. 自动增长</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 8. 多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A4%9A%E8%A1%A8%E5%85%B3%E7%B3%BB"><span class="toc-text"> 1. 多表关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%90%88%E5%B9%B6%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 2. 合并查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 3. 内连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 4. 外连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 5. 自连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2unionunion-all"><span class="toc-text"> 6. 联合查询union，union all</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 7. 子查询(嵌套查询)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%A0%87%E9%87%8F%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 1. 标量子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%97%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 2. 列子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 3. 行子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%A1%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text"> 4. 表子查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E8%A7%86%E5%9B%BE%E4%B8%8E%E7%B4%A2%E5%BC%95"><span class="toc-text"> 9. 视图与索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%A7%86%E5%9B%BE"><span class="toc-text"> 1. 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%A7%86%E5%9B%BE%E5%88%9B%E5%BB%BA"><span class="toc-text"> 1. 视图创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%A7%86%E5%9B%BE%E7%AE%A1%E7%90%86"><span class="toc-text"> 2. 视图管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95"><span class="toc-text"> 2. 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%B4%A2%E5%BC%95%E5%88%9B%E5%BB%BA"><span class="toc-text"> 1. 索引创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95%E7%AE%A1%E7%90%86"><span class="toc-text"> 2. 索引管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86"><span class="toc-text"> 10. 数据库安全管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7"><span class="toc-text"> 1. 添加用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-text"> 2. 用户管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-text"> 3. 权限管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86"><span class="toc-text"> 4. 角色管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%B0%81%E9%94%81"><span class="toc-text"> 11. 数据库并发控制与封锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E6%80%A7%E7%9A%84%E5%90%AB%E4%B9%89"><span class="toc-text"> 1. 数据库并发性的含义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BA%8B%E5%8A%A1%E5%8F%8A%E5%85%B6%E6%80%A7%E8%B4%A8"><span class="toc-text"> 2. 事务及其性质</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-mysql%E6%94%AF%E6%8C%814%E7%A7%8D%E4%BA%8B%E5%8A%A1%E6%A8%A1%E5%BC%8F"><span class="toc-text"> 1. Mysql支持4种事务模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%80%A7%E8%B4%A8%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7acid"><span class="toc-text"> 2. 事务的性质（四大特性ACID）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E7%9A%84%E6%A8%A1%E5%BC%8F"><span class="toc-text"> 3. 用户定义的模式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%9A%84%E4%B8%8D%E4%B8%80%E8%87%B4%E6%80%A7"><span class="toc-text"> 3. 并发控制与数据的不一致性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-text"> 4. 事务的隔离级别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E6%80%A7%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text"> 5. 事务隔离性的实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%B0%81%E9%94%81%E5%8F%8A%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-text"> 6. 封锁及封锁协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B0%81%E9%94%81%E7%B2%92%E5%BA%A6"><span class="toc-text"> 1. 封锁粒度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B0%81%E9%94%81%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 2. 封锁类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-text"> 3. 封锁协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%AD%BB%E9%94%81%E5%92%8C%E6%B4%BB%E9%94%81"><span class="toc-text"> 4. 死锁和活锁</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0"><span class="toc-text"> 12. 存储过程与函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%9A%E7%95%8C%E7%AC%A6%E4%B8%8E%E8%AF%AD%E5%8F%A5%E5%9D%97"><span class="toc-text"> 1. 定界符与语句块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-text"> 2. 变量定义与使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E8%B0%83%E7%94%A8"><span class="toc-text"> 3. 存储过程的创建和调用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA"><span class="toc-text"> 1. 创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E4%BF%AE%E6%94%B9%E7%89%B9%E6%80%A7%E5%88%A0%E9%99%A4"><span class="toc-text"> 2. 查看，修改特性，删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-text"> 4. 存储过程相关函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-text"> 5. 用户自定义函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%B8%B8%E6%A0%87-cursor"><span class="toc-text"> 6. 游标 cursor</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E5%92%8C%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-text"> 13. 数据库备份还原和日志管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="toc-text"> 1. 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-mysqldump%E5%91%BD%E4%BB%A4%E5%A4%87%E4%BB%BD"><span class="toc-text"> 2. mysqldump命令备份</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F"><span class="toc-text"> 3. 备份还原</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-mysql%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-text"> 4. mysql日志管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97"><span class="toc-text"> 1. 错误日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97"><span class="toc-text"> 2. 二进制日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-text"> 3. 慢查询日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%80%9A%E7%94%A8%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-text"> 4. 通用日志管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E8%8B%B1%E5%AF%B9%E7%85%A7"><span class="toc-text"> 中英对照</span></a></li></ol></li></ol>
    </article>
  
  
  <article class="card card-content">
    <div class="recent-posts-card">
  <div class="recent-posts-header">
    <i 
      class="iconfont icon-wenzhang_huaban" 
      style="padding-right: 2px;">
    </i>最近文章
  </div>
  <div class="recent-posts-list">
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-10-10</div>
        <a href="/2023/10/10/C%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80-%E4%B8%8B/"><div class="recent-posts-item-content">C语言基础-下</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-10-05</div>
        <a href="/2023/10/05/C%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80-%E4%B8%8A/"><div class="recent-posts-item-content">C语言基础-上</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-08-24</div>
        <a href="/2023/08/24/python%E5%B8%B8%E7%94%A8%E5%BA%93/"><div class="recent-posts-item-content">python常用库</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-08-24</div>
        <a href="/2023/08/24/%E6%B5%8B%E8%AF%95/"><div class="recent-posts-item-content">测试</div></a>
      </div>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
          </div>
        </div>
      </div>
    </div>
     
    <footer class="footer">
  <div class="footer-container">
    <div>
      <div class="footer-dsc">
        <span>
          Copyright ©
          
            2020
          
          
                - 
                2023
          
        </span>
        &nbsp;
        <a 
          href="/" 
          class="footer-link">
          jkloli's blog
        </a>
      </div>
    </div>

    
      <div class="footer-dsc">
        
          Powered by
          <a 
            href="https://hexo.io/" 
            class="footer-link" 
            target="_blank" 
            rel="nofollow noopener noreferrer">
            &nbsp;Hexo
          </a>
        
        
          <span>&nbsp;|&nbsp;</span>
        
        
          Theme -
          <a 
            href="https://github.com/theme-kaze" 
            class="footer-link" 
            target="_blank"
            rel="nofollow noopener noreferrer">
            &nbsp;Kaze
          </a>
        
      </div>
    
    
    
    
</footer>
 
    
  <a 
    role="button" 
    id="scrollbutton" 
    class="basebutton" 
    aria-label="回到顶部">
    <i class="iconfont icon-arrowleft button-icon"></i>
  </a>

<a 
  role="button" 
  id="menubutton"
  aria-label="menu button"
  class="basebutton">
  <i class="iconfont icon-menu button-icon"></i>
</a>
<a 
  role="button" 
  id="popbutton" 
  class="basebutton" 
  aria-label="控制中心">
  <i class="iconfont icon-expand button-icon"></i>
</a>
<a 
  role="button" 
  id="darkbutton" 
  class="basebutton darkwidget" 
  aria-label="夜色模式">
  <i class="iconfont icon-weather button-icon"></i>
</a>
<a 
  role="button" 
  id="searchbutton" 
  class="basebutton searchwidget" 
  aria-label="搜索">
  <i class="iconfont icon-search button-icon"></i>
</a> 
     
     
      
 
     
     
      <script>
  var addImgLayout = function () {
    var img = document.querySelectorAll('.post-content img')
    var i
    for (i = 0; i < img.length; i++) {
      var wrapper = document.createElement('a')
      wrapper.setAttribute('href', img[i].getAttribute('data-src'))
      wrapper.setAttribute('aria-label', 'illustration')
      wrapper.style.cssText =
        'width: 100%; display: flex; justify-content: center;'
      if (img[i].alt) wrapper.dataset.caption = img[i].alt
      wrapper.dataset.nolink = true
      img[i].before(wrapper)
      wrapper.append(img[i])
      var divWrap = document.createElement('div')
      divWrap.classList.add('gallery')
      wrapper.before(divWrap)
      divWrap.append(wrapper)
    }
    baguetteBox.run('.gallery')
  }
</script>
<script>
  loadScript(
    "/js/lib/lightbox/baguetteBox.min.js",
    addImgLayout
  )
</script>
 
     
     
    <script src="/js/main.js"></script> 
     
    
      <script>
        var addLazyload = function () {
          var observer = lozad('.lozad', {
            load: function (el) {
              el.srcset = el.getAttribute('data-src')
            },
            loaded: function (el) {
              el.classList.add('loaded')
            },
          })
          observer.observe()
        }
      </script>
      <script>
        loadScript('/js/lib/lozad.min.js', addLazyload)
      </script>
    
    <script src="//instant.page/5.1.0" type="module"
      integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script>
    
    
      <script>
        setTimeout(() => {localSearch("search.json")}, 0)
      </script>
    
  </body>
</html>
